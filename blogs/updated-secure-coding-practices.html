<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Secure Coding Guide | Best Practices for Developers</title>
    <meta name="description"
        content="Comprehensive secure coding practices guide with real-world examples in JavaScript, Python, and cURL. Learn input validation, authentication, error handling and more.">
    <meta name="keywords"
        content="ritik, ritik07, lord ritik, lord_ritik07, secure coding, web security, programming security, cybersecurity, OWASP, input validation, authentication">
    <meta name="author" content="Ritik Raj">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --accent: #dc2626;
            --light: #f8fafc;
            --dark: #1e293b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--dark);
            line-height: 1.7;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background: var(--gradient);
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 70%);
            z-index: 1;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo i {
            font-size: 2.2rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .logo h1 {
            font-size: 1.9rem;
            font-weight: 800;
            background: linear-gradient(45deg, #fff, #e0f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cta-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .youtube-btn {
            background: #ff0000;
            color: white;
            border: none;
            padding: 0.8rem 1.6rem;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
            text-decoration: none;
        }

        .youtube-btn:hover {
            background: #cc0000;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 0, 0, 0.4);
        }

        .github-btn {
            background: #333;
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 50px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .github-btn:hover {
            background: #000;
            transform: translateY(-2px);
        }

        /* Navigation */
        nav {
            background-color: white;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-links {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 1.3rem 1.6rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            color: var(--dark);
        }

        .nav-item:hover,
        .nav-item.active {
            color: var(--primary);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px 3px 0 0;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--light);
            border-radius: 50px;
            padding: 0.6rem 1.2rem;
            margin-left: 1rem;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .search-box:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-box input {
            border: none;
            background: transparent;
            outline: none;
            padding: 0.3rem;
            width: 200px;
            font-size: 0.95rem;
        }

        /* Main Content */
        main {
            padding: 2.5rem 0;
        }

        section {
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: var(--dark);
            position: relative;
        }

        .section-title h2 {
            font-size: 2.5rem;
            margin-bottom: 0.8rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .section-title p {
            color: var(--gray);
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 120px;
            height: 5px;
            background: var(--gradient);
            margin: 20px auto;
            border-radius: 3px;
        }

        /* Enhanced Topic Cards */
        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .topic-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            padding: 2.2rem;
            transition: all 0.4s ease;
            border-top: 6px solid;
            border-image: var(--gradient) 1;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: var(--gradient);
        }

        .topic-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .topic-card h3 {
            color: var(--dark);
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .topic-card h3 i {
            color: var(--primary);
            font-size: 1.8rem;
        }

        .topic-card p {
            color: var(--gray);
            margin-bottom: 1.8rem;
            font-size: 1.05rem;
            line-height: 1.7;
        }

        /* Importance Section */
        .importance-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f7fa);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border-left: 6px solid var(--primary);
        }

        .importance-section h4 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        .importance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .importance-item {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .importance-item h5 {
            color: var(--dark);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .importance-item.why-important {
            border-top: 4px solid var(--success);
        }

        .importance-item.consequences {
            border-top: 4px solid var(--danger);
        }

        .importance-item.best-practices {
            border-top: 4px solid var(--primary);
        }

        /* Incident Example */
        .incident-example {
            background: linear-gradient(135deg, #fff7ed, #fffbeb);
            border-left: 6px solid var(--warning);
            padding: 1.8rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .incident-example h4 {
            color: var(--warning);
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .incident-example p {
            color: var(--dark);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .incident-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .incident-link:hover {
            gap: 12px;
            color: var(--primary-dark);
        }

        /* Code Sections */
        .code-tabs {
            margin: 2.5rem 0;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 2px solid var(--gray-light);
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-size: 1rem;
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        .tab-content {
            display: none;
            padding: 1.5rem 0;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .code-block {
            background: #1e293b;
            border-radius: 12px;
            overflow: hidden;
            margin: 1.5rem 0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            border: 1px solid #374151;
        }

        .code-header {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #4a5568;
        }

        .code-header .badge {
            background: var(--danger);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .code-header .badge.secure {
            background: var(--success);
        }

        pre {
            margin: 0;
            padding: 1.5rem;
            overflow-x: auto;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        code {
            font-family: 'Fira Code', 'Cascadia Code', 'Courier New', monospace;
        }

        .hljs {
            background: transparent;
        }

        /* Language Tabs */
        .language-tabs {
            margin: 1.5rem 0;
        }

        .lang-tab-buttons {
            display: flex;
            border-bottom: 2px solid var(--gray-light);
            flex-wrap: wrap;
            gap: 5px;
        }

        .lang-tab-btn {
            padding: 0.8rem 1.2rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-size: 0.95rem;
            border-radius: 8px 8px 0 0;
        }

        .lang-tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .lang-tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .lang-tab-content.active {
            display: block;
        }

        /* Resource Links */
        .resource-links {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px dashed var(--gray-light);
        }

        .resource-links a {
            color: var(--primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-right: 1.5rem;
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            background: rgba(37, 99, 235, 0.05);
        }

        .resource-links a:hover {
            background: rgba(37, 99, 235, 0.1);
            transform: translateY(-2px);
        }

        /* Progress Tracker */
        .progress-tracker {
            position: fixed;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
        }

        .progress-tracker.visible {
            display: block;
            animation: slideInRight 0.5s ease;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px) translateY(-50%);
            }

            to {
                opacity: 1;
                transform: translateX(0) translateY(-50%);
            }
        }

        .progress-tracker h4 {
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .progress-items {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .progress-item:hover {
            background: var(--gray-light);
        }

        .progress-item.active {
            background: var(--primary);
            color: white;
        }

        .progress-item i {
            font-size: 0.9rem;
        }

        /* Resources Section */
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .resource-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            padding: 2.2rem;
            transition: all 0.4s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid transparent;
        }

        .resource-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .resource-card h3 {
            color: var(--dark);
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.4rem;
        }

        .resource-card p {
            color: var(--gray);
            margin-bottom: 2rem;
            flex-grow: 1;
            line-height: 1.7;
        }

        .resource-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            width: fit-content;
        }

        .resource-link:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 4rem 0 2rem;
            margin-top: 4rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-column h3 {
            margin-bottom: 1.8rem;
            font-size: 1.3rem;
            position: relative;
            padding-bottom: 0.8rem;
        }

        .footer-column h3::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background: var(--primary);
            border-radius: 2px;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 1rem;
        }

        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 3rem;
            border-top: 1px solid #374151;
            color: #94a3b8;
            font-size: 1rem;
        }

        /* Back to top button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            border: none;
            font-size: 1.2rem;
        }

        .back-to-top.visible {
            opacity: 1;
        }

        .back-to-top:hover {
            background: var(--primary-dark);
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(37, 99, 235, 0.4);
        }

        /* Statistics Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--gray);
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .progress-tracker {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }

            .nav-container {
                flex-direction: column;
                gap: 1.5rem;
            }

            .nav-links {
                justify-content: center;
            }

            .topic-grid,
            .resources-grid {
                grid-template-columns: 1fr;
            }

            .search-box {
                margin: 0;
                width: 100%;
            }

            .search-box input {
                width: 100%;
            }

            .cta-buttons {
                flex-direction: column;
                width: 100%;
            }

            .youtube-btn,
            .github-btn {
                width: 100%;
                justify-content: center;
            }

            .section-title h2 {
                font-size: 2rem;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .lang-tab-buttons {
                overflow-x: auto;
                padding-bottom: 10px;
            }

            .tab-buttons {
                overflow-x: auto;
                padding-bottom: 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 15px;
            }

            .topic-card,
            .resource-card {
                padding: 1.5rem;
            }

            .section-title h2 {
                font-size: 1.8rem;
            }

            .stat-number {
                font-size: 2.5rem;
            }
        }

        /* Print Styles */
        @media print {

            .back-to-top,
            .progress-tracker,
            .search-box,
            .cta-buttons {
                display: none !important;
            }

            .topic-card {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
    
</head>

<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-shield-alt"></i>
                    <h1>Secure Coding Practices</h1>
                </div>
                <div class="cta-buttons">
                    <a href="https://github.com/ritikraj07" class="github-btn" target="_blank">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                    <a href="https://www.youtube.com/@Beer-with-Bugs" class="youtube-btn" target="_blank">
                        <i class="fab fa-youtube"></i> Subscribe
                    </a>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container nav-container">
            <ul class="nav-links">
                <li class="nav-item active" data-target="overview">Overview</li>
                <li class="nav-item" data-target="input-validation">Input Validation</li>
                <li class="nav-item" data-target="secure-communication">Secure Communication</li>
                <li class="nav-item" data-target="authentication">Authentication</li>
                <li class="nav-item" data-target="error-handling">Error Handling</li>
                <li class="nav-item" data-target="secure-dependencies">Secure Dependencies</li>
                <li class="nav-item" data-target="resources">Resources</li>
            </ul>
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search security topics..." id="searchInput">
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- Overview Section -->
        <section id="overview" class="active">
            <div class="section-title">
                <h2>Complete Secure Coding Guide</h2>
                <p>Master the art of writing secure, resilient code that protects against cyber threats. Learn industry
                    best practices with real-world examples in JavaScript, Python, and cURL.</p>
            </div>

            <!-- Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">$4.35M</div>
                    <div class="stat-label">Average Data Breach Cost</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">287</div>
                    <div class="stat-label">Days to Identify Breach</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">94%</div>
                    <div class="stat-label">Organizations With Security Incidents</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15</div>
                    <div class="stat-label">Critical Security Practices</div>
                </div>
            </div>

            <div class="topic-grid">
                <div class="topic-card">
                    <h3><i class="fas fa-filter"></i> Input Validation</h3>
                    <p>Validate and sanitize all user inputs to prevent injection attacks and data corruption. Learn
                        proper validation techniques for different data types.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: Equifax Breach (2017)</h4>
                        <p><strong>Impact:</strong> 147 million people's sensitive data exposed</p>
                        <p><strong>Cause:</strong> Input validation vulnerability in Apache Struts</p>
                        <a href="https://www.ftc.gov/enforcement/cases-proceedings/refunds/equifax-data-breach-settlement"
                            class="incident-link" target="_blank">
                            Read Full Report <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <div class="topic-card">
                    <h3><i class="fas fa-lock"></i> Secure Communication</h3>
                    <p>Use encryption and secure protocols like HTTPS/TLS to protect data in transit. Implement proper
                        certificate management and security headers.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: Superfish Adware (2015)
                        </h4>
                        <p><strong>Impact:</strong> HTTPS connections intercepted on Lenovo laptops</p>
                        <p><strong>Cause:</strong> Pre-installed adware with self-signed certificates</p>
                        <a href="https://support.lenovo.com/us/en/solutions/ht100306" class="incident-link"
                            target="_blank">
                            Read Full Report <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <div class="topic-card">
                    <h3><i class="fas fa-key"></i> Authentication & Authorization</h3>
                    <p>Implement secure authentication mechanisms and proper access controls. Learn about multi-factor
                        authentication and session management.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: Twitter Bitcoin Scam (2020)
                        </h4>
                        <p><strong>Impact:</strong> High-profile accounts compromised for cryptocurrency scam</p>
                        <p><strong>Cause:</strong> Social engineering and authentication bypass</p>
                        <a href="https://www.justice.gov/usao-ndca/pr/three-individuals-charged-alleged-role-twitter-compromise"
                            class="incident-link" target="_blank">
                            Read Full Report <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <div class="topic-card">
                    <h3><i class="fas fa-shield-alt"></i> Password Security</h3>
                    <p>Store passwords securely using strong hashing algorithms with salt. Understand password policies
                        and secure storage practices.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: LinkedIn Breach (2012)</h4>
                        <p><strong>Impact:</strong> 6.5 million passwords leaked and cracked</p>
                        <p><strong>Cause:</strong> Passwords hashed without salt using SHA-1</p>
                        <a href="https://www.csoonline.com/article/560995/linkedin-settlement-over-2012-data-breach-offers-this-security-lesson.html"
                            class="incident-link" target="_blank">
                            Read Full Report <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <div class="topic-card">
                    <h3><i class="fas fa-bug"></i> Error Handling</h3>
                    <p>Implement secure error handling to prevent information leakage. Learn proper logging practices
                        and user-friendly error messages.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: Stack Trace Exposure</h4>
                        <p><strong>Impact:</strong> Sensitive information leaked through error messages</p>
                        <p><strong>Cause:</strong> Detailed error messages shown to users</p>
                        <a href="https://owasp.org/www-community/Improper_Error_Handling" class="incident-link"
                            target="_blank">
                            Read OWASP Guide <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <div class="topic-card">
                    <h3><i class="fas fa-cube"></i> Secure Dependencies</h3>
                    <p>Use well-maintained libraries and keep dependencies updated. Implement vulnerability scanning and
                        dependency management.</p>
                    <div class="incident-example">
                        <h4><i class="fas fa-exclamation-triangle"></i> Real-World Incident: Log4Shell (2021)</h4>
                        <p><strong>Impact:</strong> Millions of applications vulnerable to RCE</p>
                        <p><strong>Cause:</strong> Critical vulnerability in Log4j library</p>
                        <a href="https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance"
                            class="incident-link" target="_blank">
                            Read CISA Guidance <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Input Validation Section -->
        <section id="input-validation">
            <div class="section-title">
                <h2>Input Validation</h2>
                <p>Never trust user input. Learn comprehensive validation techniques to protect against injection
                    attacks and data corruption.</p>
            </div>

            <div class="topic-card">
                <h3><i class="fas fa-shield-alt"></i> Why Input Validation is Critical</h3>

                <div class="importance-section">
                    <h4><i class="fas fa-question-circle"></i> What is Input Validation?</h4>
                    <p>Input validation is the process of verifying and sanitizing all external data inputs to ensure
                        they meet expected criteria before processing. It's your application's first line of defense
                        against malicious data.</p>

                    <div class="importance-grid">
                        <div class="importance-item why-important">
                            <h5><i class="fas fa-check-circle"></i> Why It's Important</h5>
                            <ul>
                                <li>Prevents SQL Injection attacks</li>
                                <li>Blocks Cross-Site Scripting (XSS)</li>
                                <li>Stops Command Injection attacks</li>
                                <li>Prevents buffer overflows</li>
                                <li>Ensures data integrity</li>
                            </ul>
                        </div>

                        <div class="importance-item consequences">
                            <h5><i class="fas fa-exclamation-triangle"></i> Consequences of Ignoring</h5>
                            <ul>
                                <li>Data breaches and theft</li>
                                <li>Complete system compromise</li>
                                <li>Malware installation</li>
                                <li>Financial losses</li>
                                <li>Reputation damage</li>
                            </ul>
                        </div>

                        <div class="importance-item best-practices">
                            <h5><i class="fas fa-star"></i> Best Practices</h5>
                            <ul>
                                <li>Validate on both client and server</li>
                                <li>Use whitelist approach</li>
                                <li>Sanitize before processing</li>
                                <li>Use parameterized queries</li>
                                <li>Implement input length limits</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="incident-example">
                    <h4><i class="fas fa-fire"></i> Real-World Impact: Equifax Breach</h4>
                    <p><strong>The Vulnerability:</strong> Attackers exploited a input validation flaw in Apache Struts
                        to execute arbitrary code and access sensitive consumer data.</p>
                    <p><strong>The Cost:</strong> Equifax paid over $1.38 billion in settlements and saw their stock
                        price drop 30% immediately after the breach disclosure.</p>
                    <p><strong>The Lesson:</strong> Proper input validation could have prevented one of the largest data
                        breaches in history.</p>
                    <a href="https://www.ftc.gov/enforcement/cases-proceedings/refunds/equifax-data-breach-settlement"
                        class="incident-link" target="_blank">
                        Read FTC Settlement Details <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <h4><i class="fas fa-code"></i> Implementation Examples</h4>

                <div class="language-tabs">
                    <div class="lang-tab-buttons">
                        <button class="lang-tab-btn active" data-lang="js">JavaScript</button>
                        <button class="lang-tab-btn" data-lang="python">Python</button>
                        <button class="lang-tab-btn" data-lang="curl">cURL Testing</button>
                    </div>

                    <div class="lang-tab-content active" id="js-input">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Input Validation - Node.js/Express</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-javascript">const express = require('express');
const { body, validationResult } = require('express-validator');
const helmet = require('helmet');
const app = express();

app.use(helmet());
app.use(express.json());

// Comprehensive input validation for user registration
app.post('/register', [
    // Email validation
    body('email')
        .isEmail()
        .normalizeEmail()
        .withMessage('Please provide a valid email address'),
    
    // Username validation
    body('username')
        .isLength({ min: 3, max: 30 })
        .matches(/^[a-zA-Z0-9_]+$/)
        .withMessage('Username must be 3-30 characters and alphanumeric'),
    
    // Password strength validation
    body('password')
        .isLength({ min: 8 })
        .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/)
        .withMessage('Password must be 8+ chars with uppercase, lowercase, number and special character'),
    
    // Age validation
    body('age')
        .isInt({ min: 1, max: 120 })
        .withMessage('Age must be between 1 and 120'),
    
    // Phone number validation
    body('phone')
        .optional()
        .matches(/^\+?[\d\s-()]+$/)
        .withMessage('Please provide a valid phone number')

], async (req, res) => {
    // Check for validation errors
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
        return res.status(400).json({
            error: 'Validation failed',
            details: errors.array()
        });
    }

    // Input is safe to process
    const { email, username, password, age, phone } = req.body;
    
    try {
        // Process registration...
        const user = await User.create({
            email,
            username,
            password: await bcrypt.hash(password, 12),
            age,
            phone
        });
        
        res.status(201).json({
            message: 'User registered successfully',
            userId: user.id
        });
    } catch (error) {
        console.error('Registration error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// SQL Injection prevention with parameterized queries
app.get('/user/:id', [
    body('id').isInt({ min: 1 }).withMessage('Invalid user ID')
], (req, res) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
        return res.status(400).json({ errors: errors.array() });
    }
    
    const userId = req.params.id;
    
    // Safe parameterized query - prevents SQL injection
    const query = 'SELECT * FROM users WHERE id = ?';
    db.execute(query, [userId], (error, results) => {
        if (error) {
            console.error('Database error:', error);
            return res.status(500).json({ error: 'Database error' });
        }
        
        if (results.length === 0) {
            return res.status(404).json({ error: 'User not found' });
        }
        
        res.json(results[0]);
    });
});

// XSS prevention with output encoding
app.get('/search', [
    body('query').escape().trim()
], (req, res) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
        return res.status(400).json({ errors: errors.array() });
    }
    
    const searchQuery = req.query.query;
    // searchQuery is now safe from XSS attacks
    res.json({ results: performSearch(searchQuery) });
});</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="python-input">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Input Validation - Python/Flask</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python">from flask import Flask, request, jsonify
import re
import bleach
from werkzeug.security import check_password_hash, generate_password_hash

app = Flask(__name__)

class InputValidator:
    @staticmethod
    def validate_email(email):
        pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        return re.match(pattern, email) is not None
    
    @staticmethod
    def validate_username(username):
        # Only allow alphanumeric and underscores, 3-30 characters
        return re.match(r'^[a-zA-Z0-9_]{3,30}$', username) is not None
    
    @staticmethod
    def validate_password_strength(password):
        # At least 8 chars, with uppercase, lowercase, number and special char
        if len(password) < 8:
            return False, "Password must be at least 8 characters long"
        
        if not re.search(r'[A-Z]', password):
            return False, "Password must contain at least one uppercase letter"
        
        if not re.search(r'[a-z]', password):
            return False, "Password must contain at least one lowercase letter"
        
        if not re.search(r'\d', password):
            return False, "Password must contain at least one number"
        
        if not re.search(r'[@$!%*?&]', password):
            return False, "Password must contain at least one special character"
        
        return True, "Password is strong"
    
    @staticmethod
    def sanitize_input(input_string):
        # Remove potentially dangerous characters
        return bleach.clean(input_string, strip=True)

@app.route('/register', methods=['POST'])
def register():
    data = request.get_json()
    
    # Validate required fields
    required_fields = ['email', 'username', 'password']
    for field in required_fields:
        if field not in data:
            return jsonify({'error': f'Missing required field: {field}'}), 400
    
    # Validate email
    if not InputValidator.validate_email(data['email']):
        return jsonify({'error': 'Invalid email format'}), 400
    
    # Validate username
    if not InputValidator.validate_username(data['username']):
        return jsonify({'error': 'Username must be 3-30 alphanumeric characters'}), 400
    
    # Validate password strength
    is_strong, message = InputValidator.validate_password_strength(data['password'])
    if not is_strong:
        return jsonify({'error': message}), 400
    
    # Sanitize inputs
    safe_email = InputValidator.sanitize_input(data['email'])
    safe_username = InputValidator.sanitize_input(data['username'])
    
    try:
        # Create user with safe data
        user = User(
            email=safe_email,
            username=safe_username,
            password_hash=generate_password_hash(data['password'])
        )
        db.session.add(user)
        db.session.commit()
        
        return jsonify({
            'message': 'User registered successfully',
            'userId': user.id
        }), 201
        
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'Registration failed'}), 500

# SQL Injection prevention with parameterized queries
@app.route('/user/<int:user_id>')
def get_user(user_id):
    # user_id is automatically converted to integer by Flask
    # If it's not a valid integer, Flask returns 404
    
    try:
        # Safe parameterized query
        cursor = db.connection.cursor()
        cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))
        user = cursor.fetchone()
        
        if not user:
            return jsonify({'error': 'User not found'}), 404
            
        return jsonify({
            'id': user[0],
            'username': user[1],
            'email': user[2]
        })
        
    except Exception as e:
        return jsonify({'error': 'Database error'}), 500

# XSS prevention with output encoding
@app.route('/search')
def search():
    query = request.args.get('q', '')
    
    # Sanitize search query
    safe_query = InputValidator.sanitize_input(query)
    
    # Perform safe search
    results = perform_search(safe_query)
    return jsonify({'results': results})</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="curl-input">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Input Validation Testing with cURL</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-bash">#!/bin/bash
# Comprehensive Input Validation Testing Script

echo "üîç Testing Input Validation Security"

# Test 1: Valid registration data
echo -e "\n‚úÖ Testing valid registration..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "username": "valid_user123",
    "password": "SecurePass123!",
    "age": 25
  }'

# Test 2: SQL Injection attempts
echo -e "\nüö´ Testing SQL Injection prevention..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "username": "admin'\'' OR '\''1'\''='\'1",
    "password": "password123",
    "age": 25
  }'

# Test 3: XSS attempts
echo -e "\nüö´ Testing XSS prevention..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "&lt;script&gt;alert('"'"'xss'"'"')&lt;/script&gt;@example.com",
    "username": "&lt;script&gt;document.location='http://hacker.com/'&lt;/script&gt;",
    "password": "password123",
    "age": 25
  }'

# Test 4: Command Injection attempts
echo -e "\nüö´ Testing Command Injection prevention..."
curl "https://api.example.com/user/1; rm -rf /"

# Test 5: Buffer overflow attempts
echo -e "\nüö´ Testing Buffer Overflow prevention..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d "{
    \"email\": \"${printf '%5000s' 'a'}\",
    \"username\": \"${printf '%5000s' 'b'}\",
    \"password\": \"${printf '%5000s' 'c'}\"
  }"

# Test 6: Path traversal attempts
echo -e "\nüö´ Testing Path Traversal prevention..."
curl "https://api.example.com/files/../../../etc/passwd"

# Test 7: Special character testing
echo -e "\nüîß Testing special character handling..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user+tag@example.com",
    "username": "user-with-dash",
    "password": "P@ssw0rd!",
    "age": "25"
  }'

# Test 8: Type validation
echo -e "\nüîß Testing type validation..."
curl -X POST https://api.example.com/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "username": "testuser",
    "password": "Password123!",
    "age": "not-a-number"
  }'

echo -e "\nüéØ Input validation testing completed!"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="resource-links">
                    <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
                        target="_blank">
                        <i class="fas fa-external-link-alt"></i> OWASP Input Validation Cheat Sheet
                    </a>
                    <a href="https://express-validator.github.io/docs/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Express Validator Documentation
                    </a>
                    <a href="https://bleach.readthedocs.io/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Bleach Sanitization Library
                    </a>
                    <a href="https://owasp.org/www-community/attacks/SQL_Injection" target="_blank">
                        <i class="fas fa-external-link-alt"></i> OWASP SQL Injection Prevention
                    </a>
                </div>
            </div>
        </section>

        <!-- Secure Communication Section -->
        <section id="secure-communication">
            <div class="section-title">
                <h2>Secure Communication</h2>
                <p>Protect data in transit with robust encryption protocols and secure communication practices.</p>
            </div>

            <div class="topic-card">
                <h3><i class="fas fa-lock"></i> Why Secure Communication is Essential</h3>

                <div class="importance-section">
                    <h4><i class="fas fa-question-circle"></i> What is Secure Communication?</h4>
                    <p>Secure communication involves using encryption protocols like TLS/SSL to protect data as it
                        travels between clients and servers, preventing eavesdropping, tampering, and message forgery.
                    </p>

                    <div class="importance-grid">
                        <div class="importance-item why-important">
                            <h5><i class="fas fa-check-circle"></i> Why It's Important</h5>
                            <ul>
                                <li>Prevents man-in-the-middle attacks</li>
                                <li>Protects sensitive data in transit</li>
                                <li>Ensures data integrity</li>
                                <li>Builds user trust</li>
                                <li>Required for compliance (GDPR, PCI DSS)</li>
                            </ul>
                        </div>

                        <div class="importance-item consequences">
                            <h5><i class="fas fa-exclamation-triangle"></i> Consequences of Ignoring</h5>
                            <ul>
                                <li>Data interception and theft</li>
                                <li>Session hijacking</li>
                                <li>Credential theft</li>
                                <li>Legal and compliance violations</li>
                                <li>Loss of customer trust</li>
                            </ul>
                        </div>

                        <div class="importance-item best-practices">
                            <h5><i class="fas fa-star"></i> Best Practices</h5>
                            <ul>
                                <li>Always use HTTPS in production</li>
                                <li>Implement HSTS headers</li>
                                <li>Use strong TLS configurations</li>
                                <li>Regular certificate management</li>
                                <li>Enable secure cookies</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="incident-example">
                    <h4><i class="fas fa-fire"></i> Real-World Impact: Superfish Adware</h4>
                    <p><strong>The Vulnerability:</strong> Lenovo pre-installed Superfish adware that installed
                        self-signed root certificates, allowing attackers to intercept and decrypt HTTPS traffic.</p>
                    <p><strong>The Impact:</strong> Millions of users' secure connections were compromised, exposing
                        banking credentials, emails, and other sensitive data.</p>
                    <p><strong>The Lesson:</strong> Proper certificate validation and avoiding man-in-the-middle setups
                        are crucial for secure communication.</p>
                    <a href="https://support.lenovo.com/us/en/solutions/ht100306" class="incident-link" target="_blank">
                        Read Lenovo's Response <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <h4><i class="fas fa-code"></i> Implementation Examples</h4>

                <div class="language-tabs">
                    <div class="lang-tab-buttons">
                        <button class="lang-tab-btn active" data-lang="js">JavaScript</button>
                        <button class="lang-tab-btn" data-lang="python">Python</button>
                        <button class="lang-tab-btn" data-lang="curl">cURL Testing</button>
                    </div>

                    <div class="lang-tab-content active" id="js-comm">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure HTTPS Configuration - Node.js/Express</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-javascript">const express = require('express');
const helmet = require('helmet');
const https = require('https');
const fs = require('fs');
const app = express();

// Comprehensive security headers with Helmet
app.use(helmet({
    contentSecurityPolicy: {
        directives: {
            defaultSrc: ["'self'"],
            scriptSrc: ["'self'", "'trusted-cdn.com'"],
            styleSrc: ["'self'", "'unsafe-inline'"],
            imgSrc: ["'self'", "data:", "https:"],
            connectSrc: ["'self'"],
            fontSrc: ["'self'"],
            objectSrc: ["'none'"],
            mediaSrc: ["'self'"],
            frameSrc: ["'none'"],
        },
    },
    hsts: {
        maxAge: 31536000,
        includeSubDomains: true,
        preload: true
    },
    frameguard: { action: 'deny' },
    noSniff: true,
    referrerPolicy: { policy: 'strict-origin-when-cross-origin' }
}));

// Force HTTPS in production
app.use((req, res, next) => {
    if (process.env.NODE_ENV === 'production') {
        if (req.headers['x-forwarded-proto'] !== 'https') {
            return res.redirect(301, `https://${req.headers.host}${req.url}`);
        }
    }
    next();
});

// Secure cookie settings
app.use((req, res, next) => {
    res.setHeader('X-Content-Type-Options', 'nosniff');
    res.setHeader('X-Frame-Options', 'DENY');
    res.setHeader('X-XSS-Protection', '1; mode=block');
    next();
});

// HTTPS server configuration
const sslOptions = {
    key: fs.readFileSync('/path/to/private-key.pem'),
    cert: fs.readFileSync('/path/to/certificate.pem'),
    ca: fs.readFileSync('/path/to/ca-bundle.pem'),
    // Secure TLS configuration
    secureProtocol: 'TLSv1_2_method',
    ciphers: [
        'ECDHE-RSA-AES128-GCM-SHA256',
        'ECDHE-RSA-AES256-GCM-SHA384',
        'ECDHE-RSA-AES128-SHA256',
        'ECDHE-RSA-AES256-SHA384',
        '!aNULL',
        '!eNULL',
        '!EXPORT',
        '!DES',
        '!RC4',
        '!MD5',
        '!PSK',
        '!SRP',
        '!CAMELLIA'
    ].join(':'),
    honorCipherOrder: true
};

// Create HTTPS server
https.createServer(sslOptions, app).listen(443, () => {
    console.log('üîí Secure HTTPS server running on port 443');
});

// HTTP server for redirect only
const http = require('http');
http.createServer((req, res) => {
    res.writeHead(301, { 
        'Location': `https://${req.headers.host}${req.url}` 
    });
    res.end();
}).listen(80, () => {
    console.log('üì° HTTP redirect server running on port 80');
});

// Secure API routes with additional headers
app.get('/api/sensitive-data', (req, res) => {
    // Additional security headers for sensitive endpoints
    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, private');
    res.setHeader('Pragma', 'no-cache');
    res.setHeader('Expires', '0');
    
    res.json({
        message: 'This is sensitive data',
        data: protectedData
    });
});

// Security middleware for all requests
app.use((req, res, next) => {
    // Prevent clickjacking
    res.setHeader('X-Frame-Options', 'DENY');
    
    // Enable XSS filter
    res.setHeader('X-XSS-Protection', '1; mode=block');
    
    // Prevent MIME type sniffing
    res.setHeader('X-Content-Type-Options', 'nosniff');
    
    // Referrer policy
    res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');
    
    // Feature policy
    res.setHeader('Feature-Policy', "geolocation 'none'; microphone 'none'; camera 'none'");
    
    next();
});</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="python-comm">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure HTTPS Configuration - Python/Flask</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python">from flask import Flask, request, redirect, jsonify
from flask_talisman import Talisman
from flask_sslify import SSLify
import ssl

app = Flask(__name__)

# Security headers configuration
csp = {
    'default-src': ['\'self\''],
    'script-src': [
        '\'self\'',
        '\'trusted-cdn.com\'',
        '\'unsafe-inline\''
    ],
    'style-src': [
        '\'self\'',
        '\'unsafe-inline\'',
        'https://fonts.googleapis.com'
    ],
    'font-src': [
        '\'self\'',
        'https://fonts.gstatic.com'
    ],
    'img-src': [
        '\'self\'',
        'data:',
        'https:'
    ],
    'connect-src': ['\'self\''],
    'object-src': ['\'none\''],
    'media-src': ['\'self\''],
    'frame-src': ['\'none\'']
}

# Apply security headers with Talisman
talisman = Talisman(
    app,
    content_security_policy=csp,
    content_security_policy_report_uri='/csp-violation-report',
    force_https=True,
    force_https_permanent=True,
    strict_transport_security=True,
    strict_transport_security_max_age=31536000,
    strict_transport_security_include_subdomains=True,
    strict_transport_security_preload=True,
    frame_options='DENY',
    frame_options_allow_from=None,
    content_type_options=True,
    referrer_policy='strict-origin-when-cross-origin'
)

# Force SSL in production
if app.config['ENV'] == 'production':
    sslify = SSLify(app, permanent=True)

@app.before_request
def redirect_to_https():
    """Redirect HTTP to HTTPS in production"""
    if not request.is_secure:
        if request.headers.get('X-Forwarded-Proto', 'http') != 'https':
            url = request.url.replace('http://', 'https://', 1)
            return redirect(url, code=301)

@app.after_request
def apply_security_headers(response):
    """Apply additional security headers"""
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'
    
    # Remove server information
    response.headers['Server'] = 'Secure Server'
    
    # Cache control for sensitive endpoints
    if request.path.startswith('/api/'):
        response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, private'
        response.headers['Pragma'] = 'no-cache'
        response.headers['Expires'] = '0'
    
    return response

@app.route('/csp-violation-report', methods=['POST'])
def csp_report():
    """Handle CSP violation reports"""
    app.logger.warning('CSP Violation: %s', request.get_data())
    return '', 204

# SSL context configuration for development
def create_ssl_context():
    context = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
    context.load_cert_chain('server.crt', 'server.key')
    
    # Secure cipher configuration
    context.set_ciphers(
        'ECDHE-RSA-AES128-GCM-SHA256:'
        'ECDHE-RSA-AES256-GCM-SHA384:'
        'ECDHE-RSA-AES128-SHA256:'
        'ECDHE-RSA-AES256-SHA384:'
        '!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP'
    )
    
    context.options |= ssl.OP_NO_SSLv2
    context.options |= ssl.OP_NO_SSLv3
    context.options |= ssl.OP_NO_TLSv1
    context.options |= ssl.OP_NO_TLSv1_1
    
    return context

if __name__ == '__main__':
    # Run with SSL in development
    context = create_ssl_context()
    app.run(
        ssl_context=context,
        host='0.0.0.0',
        port=443,
        debug=False
    )

# Secure API endpoint example
@app.route('/api/secure-data')
def secure_data():
    """Example secure API endpoint"""
    return jsonify({
        'message': 'This data is transmitted securely',
        'status': 'success'
    })

# Health check endpoint (no sensitive headers)
@app.route('/health')
def health_check():
    return jsonify({'status': 'healthy'})</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="curl-comm">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Communication Testing with cURL</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-bash">#!/bin/bash
# Comprehensive Secure Communication Testing

echo "üîí Testing Secure Communication Configuration"

# Test 1: Check HTTPS enforcement
echo -e "\nüîê Testing HTTPS enforcement..."
curl -I http://api.example.com
curl -I https://api.example.com

# Test 2: Check security headers
echo -e "\nüìã Testing security headers..."
curl -I https://api.example.com | grep -i "strict-transport-security\|content-security-policy\|x-frame-options"

# Test 3: Test TLS configuration
echo -e "\nüîç Testing TLS configuration..."
openssl s_client -connect api.example.com:443 -tls1_2
openssl s_client -connect api.example.com:443 -tls1_1

# Test 4: Check certificate validity
echo -e "\nüìú Testing certificate validity..."
openssl s_client -connect api.example.com:443 -servername api.example.com 2>/dev/null | openssl x509 -noout -dates

# Test 5: Test cipher strength
echo -e "\nüí™ Testing cipher strength..."
nmap --script ssl-enum-ciphers -p 443 api.example.com

# Test 6: Check for vulnerable protocols
echo -e "\nüö´ Testing for vulnerable protocols..."
sslscan api.example.com

# Test 7: Test HSTS implementation
echo -e "\nüõ°Ô∏è Testing HSTS implementation..."
curl -I https://api.example.com | grep -i strict-transport-security

# Test 8: Test CSP implementation
echo -e "\nüìÑ Testing Content Security Policy..."
curl -I https://api.example.com | grep -i content-security-policy

# Test 9: Verify secure redirects
echo -e "\nüîÑ Testing secure redirects..."
curl -L http://api.example.com/secure-endpoint

# Test 10: Test mixed content
echo -e "\n‚ö†Ô∏è Testing for mixed content..."
curl https://api.example.com | grep -i "http://"

echo -e "\nüéØ Secure communication testing completed!"

# Additional security checks
echo -e "\nüîß Running additional security checks..."

# Check for certificate transparency
echo "Checking certificate transparency..."
curl -s "https://crt.sh/?q=api.example.com&output=json" | jq .

# Test OCSP stapling
echo -e "\nüìå Testing OCSP stapling..."
openssl s_client -connect api.example.com:443 -status

# Check for weak ciphers
echo -e "\nüîì Checking for weak ciphers..."
testssl.sh api.example.com

echo -e "\n‚úÖ All secure communication tests completed!"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="resource-links">
                    <a href="https://helmetjs.github.io/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Helmet.js Documentation
                    </a>
                    <a href="https://flask-talisman.readthedocs.io/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Flask Talisman Documentation
                    </a>
                    <a href="https://letsencrypt.org/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Let's Encrypt - Free SSL Certificates
                    </a>
                    <a href="https://ssl-config.mozilla.org/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Mozilla SSL Configuration Generator
                    </a>
                </div>
            </div>
        </section>

        <!-- Authentication Section -->
        <section id="authentication">
            <div class="section-title">
                <h2>Authentication & Authorization</h2>
                <p>Implement robust authentication mechanisms and proper access controls to protect user accounts and
                    data.</p>
            </div>

            <div class="topic-card">
                <h3><i class="fas fa-user-shield"></i> Why Authentication Security is Critical</h3>

                <div class="importance-section">
                    <h4><i class="fas fa-question-circle"></i> What is Secure Authentication?</h4>
                    <p>Secure authentication involves verifying user identities through multiple factors while
                        implementing proper session management, password policies, and access controls to prevent
                        unauthorized access.</p>

                    <div class="importance-grid">
                        <div class="importance-item why-important">
                            <h5><i class="fas fa-check-circle"></i> Why It's Important</h5>
                            <ul>
                                <li>Prevents unauthorized account access</li>
                                <li>Protects sensitive user data</li>
                                <li>Prevents credential stuffing attacks</li>
                                <li>Ensures proper access controls</li>
                                <li>Maintains audit trails</li>
                            </ul>
                        </div>

                        <div class="importance-item consequences">
                            <h5><i class="fas fa-exclamation-triangle"></i> Consequences of Ignoring</h5>
                            <ul>
                                <li>Account takeover and identity theft</li>
                                <li>Data breaches and privacy violations</li>
                                <li>Financial fraud and theft</li>
                                <li>Reputation damage</li>
                                <li>Legal and compliance issues</li>
                            </ul>
                        </div>

                        <div class="importance-item best-practices">
                            <h5><i class="fas fa-star"></i> Best Practices</h5>
                            <ul>
                                <li>Implement multi-factor authentication</li>
                                <li>Use strong password hashing (bcrypt)</li>
                                <li>Implement rate limiting</li>
                                <li>Use secure session management</li>
                                <li>Regular security audits</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="incident-example">
                    <h4><i class="fas fa-fire"></i> Real-World Impact: Twitter Bitcoin Scam</h4>
                    <p><strong>The Attack:</strong> Hackers used social engineering to gain access to Twitter's internal
                        tools, then compromised high-profile accounts to promote a Bitcoin scam.</p>
                    <p><strong>The Impact:</strong> 130 accounts were compromised, including Barack Obama, Joe Biden,
                        and Elon Musk. The scam netted over $100,000 in Bitcoin.</p>
                    <p><strong>The Lesson:</strong> Proper access controls, multi-factor authentication, and employee
                        training are essential for preventing social engineering attacks.</p>
                    <a href="https://www.justice.gov/usao-ndca/pr/three-individuals-charged-alleged-role-twitter-compromise"
                        class="incident-link" target="_blank">
                        Read Justice Department Report <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <h4><i class="fas fa-code"></i> Implementation Examples</h4>

                <div class="language-tabs">
                    <div class="lang-tab-buttons">
                        <button class="lang-tab-btn active" data-lang="js">JavaScript</button>
                        <button class="lang-tab-btn" data-lang="python">Python</button>
                        <button class="lang-tab-btn" data-lang="curl">cURL Testing</button>
                    </div>

                    <div class="lang-tab-content active" id="js-auth">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Authentication - Node.js/Express</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-javascript">const express = require('express');
const bcrypt = require('bcrypt');
const jwt = require('jsonwebtoken');
const rateLimit = require('express-rate-limit');
const helmet = require('helmet');
const crypto = require('crypto');

const app = express();
const JWT_SECRET = process.env.JWT_SECRET;
const BCRYPT_ROUNDS = 12;

// Security middleware
app.use(helmet());
app.use(express.json());

// Rate limiting for authentication endpoints
const authLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 5, // 5 attempts per window
    message: {
        error: 'Too many authentication attempts, please try again later.'
    },
    standardHeaders: true,
    legacyHeaders: false
});

// Apply rate limiting to auth routes
app.use('/auth/login', authLimiter);
app.use('/auth/register', authLimiter);
app.use('/auth/forgot-password', authLimiter);

// Secure password hashing utility
class PasswordManager {
    static async hashPassword(password) {
        if (password.length < 8) {
            throw new Error('Password must be at least 8 characters long');
        }
        
        const salt = await bcrypt.genSalt(BCRYPT_ROUNDS);
        return await bcrypt.hash(password, salt);
    }
    
    static async verifyPassword(password, hash) {
        return await bcrypt.compare(password, hash);
    }
    
    static validatePasswordStrength(password) {
        const requirements = {
            length: password.length >= 8,
            uppercase: /[A-Z]/.test(password),
            lowercase: /[a-z]/.test(password),
            number: /\d/.test(password),
            special: /[@$!%*?&]/.test(password)
        };
        
        const passed = Object.values(requirements).every(Boolean);
        const failedRequirements = Object.entries(requirements)
            .filter(([_, passed]) => !passed)
            .map(([req]) => req);
            
        return { passed, failedRequirements };
    }
}

// JWT token management
class TokenManager {
    static generateToken(payload, expiresIn = '1h') {
        return jwt.sign(payload, JWT_SECRET, { expiresIn });
    }
    
    static verifyToken(token) {
        try {
            return jwt.verify(token, JWT_SECRET);
        } catch (error) {
            throw new Error('Invalid or expired token');
        }
    }
    
    static generateRefreshToken() {
        return crypto.randomBytes(40).toString('hex');
    }
}

// Authentication middleware
const authenticateToken = (req, res, next) => {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN
    
    if (!token) {
        return res.status(401).json({ error: 'Access token required' });
    }
    
    try {
        const decoded = TokenManager.verifyToken(token);
        req.user = decoded;
        next();
    } catch (error) {
        return res.status(403).json({ error: 'Invalid or expired token' });
    }
};

// User registration with secure practices
app.post('/auth/register', async (req, res) => {
    try {
        const { email, password, username } = req.body;
        
        // Input validation
        if (!email || !password || !username) {
            return res.status(400).json({ error: 'All fields are required' });
        }
        
        // Validate password strength
        const strengthCheck = PasswordManager.validatePasswordStrength(password);
        if (!strengthCheck.passed) {
            return res.status(400).json({
                error: 'Password does not meet requirements',
                failedRequirements: strengthCheck.failedRequirements
            });
        }
        
        // Check if user already exists
        const existingUser = await User.findOne({ 
            $or: [{ email }, { username }] 
        });
        
        if (existingUser) {
            // Generic error to prevent user enumeration
            return res.status(400).json({ 
                error: 'Registration failed. Please try different credentials.' 
            });
        }
        
        // Hash password
        const hashedPassword = await PasswordManager.hashPassword(password);
        
        // Create user
        const user = new User({
            email,
            username,
            password: hashedPassword,
            createdAt: new Date(),
            lastLogin: null,
            failedLoginAttempts: 0,
            accountLocked: false
        });
        
        await user.save();
        
        // Generate tokens
        const accessToken = TokenManager.generateToken(
            { userId: user._id, email: user.email },
            '15m' // Short-lived access token
        );
        
        const refreshToken = TokenManager.generateRefreshToken();
        
        // Store refresh token securely
        await RefreshToken.create({
            userId: user._id,
            token: refreshToken,
            expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000) // 7 days
        });
        
        res.status(201).json({
            message: 'User registered successfully',
            accessToken,
            refreshToken,
            user: {
                id: user._id,
                email: user.email,
                username: user.username
            }
        });
        
    } catch (error) {
        console.error('Registration error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Secure login implementation
app.post('/auth/login', async (req, res) => {
    try {
        const { email, password } = req.body;
        
        if (!email || !password) {
            return res.status(400).json({ error: 'Email and password required' });
        }
        
        // Find user (prevent timing attacks)
        const user = await User.findOne({ email }).select('+password +failedLoginAttempts +accountLocked');
        
        // Generic error message to prevent user enumeration
        const genericError = 'Invalid email or password';
        
        if (!user) {
            // Simulate password verification to prevent timing attacks
            await bcrypt.compare(password, '$2b$12$fakeHashForTimingAttackPrevention');
            return res.status(401).json({ error: genericError });
        }
        
        // Check if account is locked
        if (user.accountLocked) {
            return res.status(423).json({ 
                error: 'Account temporarily locked. Please try again later or reset your password.' 
            });
        }
        
        // Verify password
        const isValidPassword = await PasswordManager.verifyPassword(password, user.password);
        
        if (!isValidPassword) {
            // Increment failed login attempts
            user.failedLoginAttempts += 1;
            
            // Lock account after 5 failed attempts
            if (user.failedLoginAttempts >= 5) {
                user.accountLocked = true;
                user.lockUntil = new Date(Date.now() + 30 * 60 * 1000); // 30 minutes
            }
            
            await user.save();
            return res.status(401).json({ error: genericError });
        }
        
        // Reset failed attempts on successful login
        user.failedLoginAttempts = 0;
        user.accountLocked = false;
        user.lastLogin = new Date();
        await user.save();
        
        // Generate tokens
        const accessToken = TokenManager.generateToken(
            { userId: user._id, email: user.email },
            '15m'
        );
        
        const refreshToken = TokenManager.generateRefreshToken();
        
        // Store refresh token
        await RefreshToken.create({
            userId: user._id,
            token: refreshToken,
            expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
        });
        
        res.json({
            message: 'Login successful',
            accessToken,
            refreshToken,
            user: {
                id: user._id,
                email: user.email,
                username: user.username
            }
        });
        
    } catch (error) {
        console.error('Login error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Token refresh endpoint
app.post('/auth/refresh', async (req, res) => {
    try {
        const { refreshToken } = req.body;
        
        if (!refreshToken) {
            return res.status(400).json({ error: 'Refresh token required' });
        }
        
        // Verify refresh token
        const storedToken = await RefreshToken.findOne({
            token: refreshToken,
            expiresAt: { $gt: new Date() }
        });
        
        if (!storedToken) {
            return res.status(403).json({ error: 'Invalid or expired refresh token' });
        }
        
        // Get user
        const user = await User.findById(storedToken.userId);
        if (!user) {
            return res.status(403).json({ error: 'User not found' });
        }
        
        // Generate new access token
        const newAccessToken = TokenManager.generateToken(
            { userId: user._id, email: user.email },
            '15m'
        );
        
        res.json({
            accessToken: newAccessToken
        });
        
    } catch (error) {
        console.error('Token refresh error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Protected route example
app.get('/api/profile', authenticateToken, async (req, res) => {
    try {
        const user = await User.findById(req.user.userId).select('-password');
        res.json({ user });
    } catch (error) {
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Logout endpoint
app.post('/auth/logout', authenticateToken, async (req, res) => {
    try {
        // Invalidate refresh token
        await RefreshToken.deleteMany({ userId: req.user.userId });
        
        res.json({ message: 'Logout successful' });
    } catch (error) {
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Password reset functionality
app.post('/auth/forgot-password', async (req, res) => {
    try {
        const { email } = req.body;
        
        if (!email) {
            return res.status(400).json({ error: 'Email required' });
        }
        
        // Find user (always return success to prevent email enumeration)
        const user = await User.findOne({ email });
        if (user) {
            // Generate reset token
            const resetToken = crypto.randomBytes(32).toString('hex');
            const resetTokenExpiry = new Date(Date.now() + 60 * 60 * 1000); // 1 hour
            
            user.resetPasswordToken = resetToken;
            user.resetPasswordExpires = resetTokenExpiry;
            await user.save();
            
            // In production, send email with reset link
            console.log(`Password reset token for ${email}: ${resetToken}`);
        }
        
        // Always return success to prevent email enumeration
        res.json({ 
            message: 'If the email exists, a password reset link has been sent.' 
        });
        
    } catch (error) {
        console.error('Password reset error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="python-auth">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Authentication - Python/Flask</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python">from flask import Flask, request, jsonify
import bcrypt
import jwt
import datetime
from functools import wraps
import secrets
from datetime import datetime, timedelta

app = Flask(__name__)
app.config['SECRET_KEY'] = 'your-secure-secret-key'
app.config['BCRYPT_ROUNDS'] = 12

class PasswordManager:
    @staticmethod
    def hash_password(password):
        if len(password) < 8:
            raise ValueError("Password must be at least 8 characters long")
        
        # Generate salt and hash password
        salt = bcrypt.gensalt(rounds=app.config['BCRYPT_ROUNDS'])
        hashed = bcrypt.hashpw(password.encode('utf-8'), salt)
        return hashed.decode('utf-8')
    
    @staticmethod
    def verify_password(password, hashed):
        return bcrypt.checkpw(password.encode('utf-8'), hashed.encode('utf-8'))
    
    @staticmethod
    def validate_password_strength(password):
        requirements = {
            'length': len(password) >= 8,
            'uppercase': any(c.isupper() for c in password),
            'lowercase': any(c.islower() for c in password),
            'number': any(c.isdigit() for c in password),
            'special': any(not c.isalnum() for c in password)
        }
        
        passed = all(requirements.values())
        failed = [k for k, v in requirements.items() if not v]
        
        return passed, failed

class TokenManager:
    @staticmethod
    def generate_token(user_id, email, expires_minutes=15):
        payload = {
            'user_id': user_id,
            'email': email,
            'exp': datetime.utcnow() + timedelta(minutes=expires_minutes),
            'iat': datetime.utcnow()
        }
        return jwt.encode(payload, app.config['SECRET_KEY'], algorithm='HS256')
    
    @staticmethod
    def verify_token(token):
        try:
            payload = jwt.decode(token, app.config['SECRET_KEY'], algorithms=['HS256'])
            return payload
        except jwt.ExpiredSignatureError:
            raise ValueError("Token has expired")
        except jwt.InvalidTokenError:
            raise ValueError("Invalid token")
    
    @staticmethod
    def generate_refresh_token():
        return secrets.token_urlsafe(32)

def token_required(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        token = None
        
        # Get token from header
        if 'Authorization' in request.headers:
            auth_header = request.headers['Authorization']
            try:
                token = auth_header.split(" ")[1]  # Bearer TOKEN
            except IndexError:
                return jsonify({'error': 'Invalid authorization header format'}), 401
        
        if not token:
            return jsonify({'error': 'Token is missing'}), 401
        
        try:
            data = TokenManager.verify_token(token)
            current_user = data
        except ValueError as e:
            return jsonify({'error': str(e)}), 401
        
        return f(current_user, *args, **kwargs)
    return decorated

# Rate limiting decorator
def rate_limit(max_attempts=5, window_minutes=15):
    def decorator(f):
        attempts = {}
        
        @wraps(f)
        def decorated(*args, **kwargs):
            client_ip = request.remote_addr
            now = datetime.now()
            
            # Clean old attempts
            attempts[client_ip] = [attempt for attempt in attempts.get(client_ip, []) 
                                 if attempt > now - timedelta(minutes=window_minutes)]
            
            # Check if rate limited
            if len(attempts[client_ip]) >= max_attempts:
                return jsonify({
                    'error': f'Too many attempts. Please try again in {window_minutes} minutes.'
                }), 429
            
            # Record this attempt
            attempts[client_ip].append(now)
            
            return f(*args, **kwargs)
        return decorated
    return decorator

@app.route('/auth/register', methods=['POST'])
@rate_limit(max_attempts=3, window_minutes=60)
def register():
    try:
        data = request.get_json()
        
        # Validate required fields
        required_fields = ['email', 'password', 'username']
        for field in required_fields:
            if field not in data:
                return jsonify({'error': f'Missing required field: {field}'}), 400
        
        email = data['email']
        password = data['password']
        username = data['username']
        
        # Validate password strength
        is_strong, failed_reqs = PasswordManager.validate_password_strength(password)
        if not is_strong:
            return jsonify({
                'error': 'Password does not meet requirements',
                'failed_requirements': failed_reqs
            }), 400
        
        # Check if user exists
        existing_user = User.query.filter(
            (User.email == email) | (User.username == username)
        ).first()
        
        if existing_user:
            # Prevent user enumeration
            return jsonify({'error': 'Registration failed'}), 400
        
        # Hash password
        hashed_password = PasswordManager.hash_password(password)
        
        # Create user
        user = User(
            email=email,
            username=username,
            password_hash=hashed_password,
            created_at=datetime.utcnow(),
            failed_login_attempts=0,
            account_locked=False
        )
        
        db.session.add(user)
        db.session.commit()
        
        # Generate tokens
        access_token = TokenManager.generate_token(user.id, user.email)
        refresh_token = TokenManager.generate_refresh_token()
        
        # Store refresh token
        refresh_token_record = RefreshToken(
            user_id=user.id,
            token=refresh_token,
            expires_at=datetime.utcnow() + timedelta(days=7)
        )
        db.session.add(refresh_token_record)
        db.session.commit()
        
        return jsonify({
            'message': 'User registered successfully',
            'access_token': access_token,
            'refresh_token': refresh_token,
            'user': {
                'id': user.id,
                'email': user.email,
                'username': user.username
            }
        }), 201
        
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'Registration failed'}), 500

@app.route('/auth/login', methods=['POST'])
@rate_limit(max_attempts=5, window_minutes=15)
def login():
    try:
        data = request.get_json()
        email = data.get('email')
        password = data.get('password')
        
        if not email or not password:
            return jsonify({'error': 'Email and password required'}), 400
        
        # Find user
        user = User.query.filter_by(email=email).first()
        
        # Generic error to prevent timing attacks and user enumeration
        generic_error = 'Invalid email or password'
        
        if not user:
            # Simulate password verification
            PasswordManager.verify_password('fake_password', 
                '$2b$12$fakeHashForTimingAttackPrevention')
            return jsonify({'error': generic_error}), 401
        
        # Check if account is locked
        if user.account_locked:
            if user.lock_until and user.lock_until > datetime.utcnow():
                return jsonify({'error': 'Account temporarily locked'}), 423
            else:
                # Unlock account if lock period has passed
                user.account_locked = False
                user.failed_login_attempts = 0
        
        # Verify password
        if not PasswordManager.verify_password(password, user.password_hash):
            # Increment failed attempts
            user.failed_login_attempts += 1
            
            # Lock account after 5 failed attempts
            if user.failed_login_attempts >= 5:
                user.account_locked = True
                user.lock_until = datetime.utcnow() + timedelta(minutes=30)
            
            db.session.commit()
            return jsonify({'error': generic_error}), 401
        
        # Reset failed attempts on successful login
        user.failed_login_attempts = 0
        user.last_login = datetime.utcnow()
        db.session.commit()
        
        # Generate tokens
        access_token = TokenManager.generate_token(user.id, user.email)
        refresh_token = TokenManager.generate_refresh_token()
        
        # Store refresh token
        refresh_token_record = RefreshToken(
            user_id=user.id,
            token=refresh_token,
            expires_at=datetime.utcnow() + timedelta(days=7)
        )
        db.session.add(refresh_token_record)
        db.session.commit()
        
        return jsonify({
            'message': 'Login successful',
            'access_token': access_token,
            'refresh_token': refresh_token,
            'user': {
                'id': user.id,
                'email': user.email,
                'username': user.username
            }
        })
        
    except Exception as e:
        return jsonify({'error': 'Login failed'}), 500

@app.route('/auth/refresh', methods=['POST'])
def refresh_token():
    try:
        data = request.get_json()
        refresh_token = data.get('refresh_token')
        
        if not refresh_token:
            return jsonify({'error': 'Refresh token required'}), 400
        
        # Verify refresh token
        token_record = RefreshToken.query.filter_by(
            token=refresh_token
        ).filter(
            RefreshToken.expires_at > datetime.utcnow()
        ).first()
        
        if not token_record:
            return jsonify({'error': 'Invalid or expired refresh token'}), 403
        
        user = User.query.get(token_record.user_id)
        if not user:
            return jsonify({'error': 'User not found'}), 403
        
        # Generate new access token
        new_access_token = TokenManager.generate_token(user.id, user.email)
        
        return jsonify({
            'access_token': new_access_token
        })
        
    except Exception as e:
        return jsonify({'error': 'Token refresh failed'}), 500

@app.route('/api/profile')
@token_required
def get_profile(current_user):
    try:
        user = User.query.get(current_user['user_id'])
        return jsonify({
            'user': {
                'id': user.id,
                'email': user.email,
                'username': user.username,
                'created_at': user.created_at.isoformat()
            }
        })
    except Exception as e:
        return jsonify({'error': 'Failed to fetch profile'}), 500

@app.route('/auth/logout', methods=['POST'])
@token_required
def logout(current_user):
    try:
        # Delete all refresh tokens for the user
        RefreshToken.query.filter_by(user_id=current_user['user_id']).delete()
        db.session.commit()
        
        return jsonify({'message': 'Logout successful'})
    except Exception as e:
        return jsonify({'error': 'Logout failed'}), 500</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="curl-auth">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Authentication Testing with cURL</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-bash">#!/bin/bash
# Comprehensive Authentication Security Testing

echo "üîê Testing Authentication Security"

# Test 1: User registration
echo -e "\nüë§ Testing user registration..."
curl -X POST https://api.example.com/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "testuser@example.com",
    "username": "secureuser123",
    "password": "SecurePass123!"
  }'

# Test 2: Login with correct credentials
echo -e "\n‚úÖ Testing successful login..."
response=$(curl -s -X POST https://api.example.com/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "testuser@example.com",
    "password": "SecurePass123!"
  }')

echo "$response"
token=$(echo "$response" | grep -o '"access_token":"[^"]*' | cut -d'"' -f4)

# Test 3: Access protected route with valid token
echo -e "\nüîí Testing protected route access..."
curl -X GET https://api.example.com/api/profile \
  -H "Authorization: Bearer $token"

# Test 4: Test rate limiting
echo -e "\n‚è∞ Testing rate limiting..."
for i in {1..6}; do
  echo "Attempt $i:"
  curl -X POST https://api.example.com/auth/login \
    -H "Content-Type: application/json" \
    -d '{
      "email": "test@example.com",
      "password": "wrongpassword"
    }'
  echo
done

# Test 5: Test weak password rejection
echo -e "\nüö´ Testing weak password rejection..."
curl -X POST https://api.example.com/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "weak@example.com",
    "username": "weakuser",
    "password": "123"
  }'

# Test 6: Test SQL injection in login
echo -e "\nüö´ Testing SQL injection prevention..."
curl -X POST https://api.example.com/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin'\'' OR '\''1'\''='\'1--",
    "password": "anything"
  }'

# Test 7: Test token refresh
echo -e "\nüîÑ Testing token refresh..."
curl -X POST https://api.example.com/auth/refresh \
  -H "Content-Type: application/json" \
  -d '{
    "refresh_token": "your-refresh-token-here"
  }'

# Test 8: Test logout functionality
echo -e "\nüö™ Testing logout..."
curl -X POST https://api.example.com/auth/logout \
  -H "Authorization: Bearer $token"

# Test 9: Test access with invalid token
echo -e "\n‚ùå Testing invalid token rejection..."
curl -X GET https://api.example.com/api/profile \
  -H "Authorization: Bearer invalid-token-here"

# Test 10: Test password reset
echo -e "\nüìß Testing password reset..."
curl -X POST https://api.example.com/auth/forgot-password \
  -H "Content-Type: application/json" \
  -d '{
    "email": "testuser@example.com"
  }'

# Test 11: Test user enumeration prevention
echo -e "\nüïµÔ∏è Testing user enumeration prevention..."
curl -X POST https://api.example.com/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "nonexistent@example.com",
    "password": "anypassword"
  }'

# Test 12: Test account lockout
echo -e "\nüîê Testing account lockout mechanism..."
for i in {1..5}; do
  curl -X POST https://api.example.com/auth/login \
    -H "Content-Type: application/json" \
    -d '{
      "email": "testuser@example.com",
      "password": "wrongpassword"
    }'
done

# Try login after lockout
curl -X POST https://api.example.com/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "testuser@example.com",
    "password": "SecurePass123!"
  }'

echo -e "\nüéØ Authentication security testing completed!"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="resource-links">
                    <a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
                        target="_blank">
                        <i class="fas fa-external-link-alt"></i> OWASP Authentication Cheat Sheet
                    </a>
                    <a href="https://auth0.com/docs/security" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Auth0 Security Best Practices
                    </a>
                    <a href="https://bcrypt-generator.com/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Bcrypt Password Generator
                    </a>
                    <a href="https://jwt.io/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> JWT.io Debugger
                    </a>
                </div>
            </div>
        </section>

        <!-- Error Handling Section -->
        <section id="error-handling">
            <div class="section-title">
                <h2>Secure Error Handling</h2>
                <p>Implement proper error handling to prevent information leakage while maintaining useful debugging
                    capabilities.</p>
            </div>

            <div class="topic-card">
                <h3><i class="fas fa-exclamation-triangle"></i> Why Secure Error Handling is Essential</h3>

                <div class="importance-section">
                    <h4><i class="fas fa-question-circle"></i> What is Secure Error Handling?</h4>
                    <p>Secure error handling involves managing exceptions and errors in a way that provides useful
                        information for developers while preventing sensitive data exposure to attackers.</p>

                    <div class="importance-grid">
                        <div class="importance-item why-important">
                            <h5><i class="fas fa-check-circle"></i> Why It's Important</h5>
                            <ul>
                                <li>Prevents information leakage</li>
                                <li>Protects sensitive system details</li>
                                <li>Maintains user experience</li>
                                <li>Enables proper debugging</li>
                                <li>Prevents attacker reconnaissance</li>
                            </ul>
                        </div>

                        <div class="importance-item consequences">
                            <h5><i class="fas fa-exclamation-triangle"></i> Consequences of Ignoring</h5>
                            <ul>
                                <li>Database structure exposure</li>
                                <li>API key and credential leakage</li>
                                <li>System path disclosure</li>
                                <li>Attack vector identification</li>
                                <li>User data compromise</li>
                            </ul>
                        </div>

                        <div class="importance-item best-practices">
                            <h5><i class="fas fa-star"></i> Best Practices</h5>
                            <ul>
                                <li>Use generic error messages in production</li>
                                <li>Log detailed errors securely</li>
                                <li>Implement structured logging</li>
                                <li>Use error correlation IDs</li>
                                <li>Monitor error patterns</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="incident-example">
                    <h4><i class="fas fa-fire"></i> Real-World Impact: Stack Trace Information Leakage</h4>
                    <p><strong>The Vulnerability:</strong> Many applications display detailed error messages and stack
                        traces to users, revealing sensitive information about the application's architecture and
                        dependencies.</p>
                    <p><strong>The Risk:</strong> Attackers can use this information to identify specific software
                        versions, database structures, and potential attack vectors for exploitation.</p>
                    <p><strong>The Lesson:</strong> Always use generic error messages in production and log detailed
                        errors securely for internal debugging only.</p>
                    <a href="https://owasp.org/www-community/Improper_Error_Handling" class="incident-link"
                        target="_blank">
                        Read OWASP Error Handling Guide <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <h4><i class="fas fa-code"></i> Implementation Examples</h4>

                <div class="language-tabs">
                    <div class="lang-tab-buttons">
                        <button class="lang-tab-btn active" data-lang="js">JavaScript</button>
                        <button class="lang-tab-btn" data-lang="python">Python</button>
                        <button class="lang-tab-btn" data-lang="curl">cURL Testing</button>
                    </div>

                    <div class="lang-tab-content active" id="js-error">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Error Handling - Node.js/Express</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-javascript">const express = require('express');
const winston = require('winston');
const { v4: uuidv4 } = require('uuid');
const app = express();

// Configure secure logging
const logger = winston.createLogger({
    level: process.env.LOG_LEVEL || 'info',
    format: winston.format.combine(
        winston.format.timestamp(),
        winston.format.errors({ stack: true }),
        winston.format.json()
    ),
    defaultMeta: { service: 'api-service' },
    transports: [
        // Write all logs with importance level of `error` or less to `error.log`
        new winston.transports.File({ 
            filename: 'logs/error.log', 
            level: 'error',
            format: winston.format.combine(
                winston.format.timestamp(),
                winston.format.json()
            )
        }),
        // Write all logs to `combined.log`
        new winston.transports.File({ 
            filename: 'logs/combined.log',
            format: winston.format.combine(
                winston.format.timestamp(),
                winston.format.json()
            )
        }),
        // Also log to console in development
        new winston.transports.Console({
            format: winston.format.combine(
                winston.format.colorize(),
                winston.format.simple()
            )
        })
    ]
});

// Request ID middleware for error correlation
app.use((req, res, next) => {
    req.id = uuidv4();
    next();
});

// Structured error class
class AppError extends Error {
    constructor(message, statusCode = 500, isOperational = true) {
        super(message);
        this.statusCode = statusCode;
        this.isOperational = isOperational;
        this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';
        this.timestamp = new Date().toISOString();
        
        Error.captureStackTrace(this, this.constructor);
    }
}

class ValidationError extends AppError {
    constructor(message, details = []) {
        super(message, 400);
        this.details = details;
        this.name = 'ValidationError';
    }
}

class AuthenticationError extends AppError {
    constructor(message = 'Authentication failed') {
        super(message, 401);
        this.name = 'AuthenticationError';
    }
}

class AuthorizationError extends AppError {
    constructor(message = 'Access denied') {
        super(message, 403);
        this.name = 'AuthorizationError';
    }
}

class NotFoundError extends AppError {
    constructor(resource = 'Resource') {
        super(`${resource} not found`, 404);
        this.name = 'NotFoundError';
    }
}

// Secure error response formatter
const errorResponse = (error, req) => {
    const baseResponse = {
        error: {
            message: error.message,
            code: error.statusCode,
            reference: req.id,
            timestamp: error.timestamp
        }
    };
    
    // Include validation details if available
    if (error.details) {
        baseResponse.error.details = error.details;
    }
    
    // In development, include stack trace
    if (process.env.NODE_ENV === 'development') {
        baseResponse.error.stack = error.stack;
    }
    
    return baseResponse;
};

// Global error handling middleware
const errorHandler = (error, req, res, next) => {
    // Set default values if error is not an AppError
    error.statusCode = error.statusCode || 500;
    error.status = error.status || 'error';
    error.timestamp = error.timestamp || new Date().toISOString();
    
    // Log error with context
    logger.error('Application error occurred', {
        error: {
            message: error.message,
            stack: error.stack,
            name: error.name,
            code: error.statusCode
        },
        request: {
            id: req.id,
            method: req.method,
            url: req.url,
            ip: req.ip,
            userAgent: req.get('User-Agent'),
            userId: req.user ? req.user.id : 'anonymous'
        },
        timestamp: error.timestamp
    });
    
    // Send appropriate response based on environment
    if (process.env.NODE_ENV === 'production') {
        // Production: Generic error messages
        if (error.isOperational) {
            // Operational errors (trusted) - show specific message
            res.status(error.statusCode).json(errorResponse(error, req));
        } else {
            // Programming or unknown errors - generic message
            res.status(500).json({
                error: {
                    message: 'Something went wrong',
                    code: 500,
                    reference: req.id,
                    timestamp: error.timestamp
                }
            });
        }
    } else {
        // Development: Detailed error information
        res.status(error.statusCode).json(errorResponse(error, req));
    }
};

// 404 handler
app.use('*', (req, res, next) => {
    next(new NotFoundError(`Route ${req.originalUrl} not found`));
});

// Async error handler wrapper
const asyncHandler = (fn) => (req, res, next) => {
    Promise.resolve(fn(req, res, next)).catch(next);
};

// Example secure route with error handling
app.get('/api/users/:id', asyncHandler(async (req, res, next) => {
    const userId = req.params.id;
    
    // Input validation
    if (!userId || !/^[0-9a-fA-F]{24}$/.test(userId)) {
        throw new ValidationError('Invalid user ID format');
    }
    
    try {
        const user = await User.findById(userId);
        
        if (!user) {
            throw new NotFoundError('User');
        }
        
        // Check authorization
        if (req.user.id !== user.id && !req.user.isAdmin) {
            throw new AuthorizationError();
        }
        
        res.json({
            data: {
                id: user.id,
                email: user.email,
                username: user.username
            }
        });
        
    } catch (error) {
        // Handle specific database errors
        if (error.name === 'CastError') {
            throw new ValidationError('Invalid user ID');
        }
        
        // Re-throw the error to be handled by global error handler
        throw error;
    }
}));

// Example with transaction and rollback
app.post('/api/transfer', asyncHandler(async (req, res, next) => {
    const { fromAccount, toAccount, amount } = req.body;
    
    // Input validation
    if (!fromAccount || !toAccount || !amount) {
        throw new ValidationError('Missing required fields', [
            { field: 'fromAccount', message: 'Required' },
            { field: 'toAccount', message: 'Required' },
            { field: 'amount', message: 'Required' }
        ]);
    }
    
    if (amount <= 0) {
        throw new ValidationError('Amount must be positive');
    }
    
    const session = await mongoose.startSession();
    
    try {
        session.startTransaction();
        
        // Check if fromAccount has sufficient funds
        const fromAccountDoc = await Account.findById(fromAccount).session(session);
        if (!fromAccountDoc) {
            throw new NotFoundError('Source account');
        }
        
        if (fromAccountDoc.balance < amount) {
            throw new AppError('Insufficient funds', 400);
        }
        
        // Check if toAccount exists
        const toAccountDoc = await Account.findById(toAccount).session(session);
        if (!toAccountDoc) {
            throw new NotFoundError('Destination account');
        }
        
        // Perform transfer
        fromAccountDoc.balance -= amount;
        toAccountDoc.balance += amount;
        
        await fromAccountDoc.save({ session });
        await toAccountDoc.save({ session });
        
        // Create transaction record
        const transaction = new Transaction({
            fromAccount,
            toAccount,
            amount,
            timestamp: new Date()
        });
        
        await transaction.save({ session });
        
        // Commit transaction
        await session.commitTransaction();
        
        logger.info('Transfer completed successfully', {
            transactionId: transaction.id,
            fromAccount,
            toAccount,
            amount,
            requestId: req.id
        });
        
        res.json({
            message: 'Transfer completed successfully',
            transactionId: transaction.id
        });
        
    } catch (error) {
        // Rollback transaction on error
        await session.abortTransaction();
        
        logger.error('Transfer failed', {
            error: error.message,
            fromAccount,
            toAccount,
            amount,
            requestId: req.id
        });
        
        throw error;
    } finally {
        session.endSession();
    }
}));

// Security middleware for error prevention
app.use((req, res, next) => {
    // Prevent stack trace leakage
    const originalSend = res.send;
    res.send = function(data) {
        // Ensure no error objects are sent directly
        if (data instanceof Error) {
            logger.error('Attempted to send Error object directly', {
                error: data.message,
                requestId: req.id
            });
            return originalSend.call(this, {
                error: {
                    message: 'Internal server error',
                    code: 500,
                    reference: req.id
                }
            });
        }
        originalSend.call(this, data);
    };
    next();
});

// Process-level error handlers
process.on('unhandledRejection', (reason, promise) => {
    logger.error('Unhandled Promise Rejection', {
        reason: reason instanceof Error ? reason.stack : reason,
        promise
    });
    
    // In production, exit process after logging
    if (process.env.NODE_ENV === 'production') {
        process.exit(1);
    }
});

process.on('uncaughtException', (error) => {
    logger.error('Uncaught Exception', {
        error: error.stack,
        timestamp: new Date().toISOString()
    });
    
    // Exit process in production
    if (process.env.NODE_ENV === 'production') {
        process.exit(1);
    }
});

// Apply global error handler (must be last)
app.use(errorHandler);

module.exports = app;</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="python-error">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Error Handling - Python/Flask</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python">from flask import Flask, request, jsonify
import logging
import sys
import uuid
from datetime import datetime
from functools import wraps
import traceback

app = Flask(__name__)

# Configure secure logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s - [%(correlation_id)s]',
    handlers=[
        logging.FileHandler('logs/error.log'),
        logging.StreamHandler(sys.stdout)
    ]
)

logger = logging.getLogger(__name__)

# Custom exception classes
class AppError(Exception):
    """Base application error class"""
    def __init__(self, message, status_code=500, details=None):
        super().__init__(message)
        self.message = message
        self.status_code = status_code
        self.details = details
        self.timestamp = datetime.utcnow().isoformat()
        self.correlation_id = None

class ValidationError(AppError):
    """Validation error"""
    def __init__(self, message, details=None):
        super().__init__(message, 400, details)

class AuthenticationError(AppError):
    """Authentication error"""
    def __init__(self, message="Authentication failed"):
        super().__init__(message, 401)

class AuthorizationError(AppError):
    """Authorization error"""
    def __init__(self, message="Access denied"):
        super().__init__(message, 403)

class NotFoundError(AppError):
    """Resource not found error"""
    def __init__(self, resource="Resource"):
        super().__init__(f"{resource} not found", 404)

class DatabaseError(AppError):
    """Database operation error"""
    def __init__(self, message="Database operation failed"):
        super().__init__(message, 500)

# Request ID middleware
@app.before_request
def assign_correlation_id():
    """Assign correlation ID to each request"""
    request.correlation_id = str(uuid.uuid4())

# Error response formatter
def error_response(error, include_details=False):
    """Format error response securely"""
    response = {
        'error': {
            'message': error.message,
            'code': error.status_code,
            'reference': getattr(error, 'correlation_id', None),
            'timestamp': getattr(error, 'timestamp', datetime.utcnow().isoformat())
        }
    }
    
    # Include details only in development or for specific error types
    if include_details and error.details:
        response['error']['details'] = error.details
    
    return response

# Global error handler
@app.errorhandler(AppError)
def handle_app_error(error):
    """Handle application errors"""
    error.correlation_id = request.correlation_id
    
    # Log the error
    logger.error(f"Application error: {error.message}", extra={
        'correlation_id': error.correlation_id,
        'status_code': error.status_code,
        'url': request.url,
        'method': request.method,
        'user_agent': request.headers.get('User-Agent'),
        'ip': request.remote_addr
    })
    
    # Determine if we should include details
    include_details = app.debug or app.testing
    
    return jsonify(error_response(error, include_details)), error.status_code

@app.errorhandler(404)
def handle_404(error):
    """Handle 404 errors"""
    not_found_error = NotFoundError()
    not_found_error.correlation_id = request.correlation_id
    
    logger.warning(f"404 Not Found: {request.url}", extra={
        'correlation_id': request.correlation_id,
        'method': request.method
    })
    
    return jsonify(error_response(not_found_error)), 404

@app.errorhandler(500)
def handle_500(error):
    """Handle 500 errors"""
    app_error = AppError("Internal server error")
    app_error.correlation_id = request.correlation_id
    
    # Log the actual error with stack trace
    logger.error(f"500 Internal Server Error: {str(error)}", extra={
        'correlation_id': request.correlation_id,
        'stack_trace': traceback.format_exc(),
        'url': request.url,
        'method': request.method
    })
    
    # In production, return generic error
    if not app.debug and not app.testing:
        return jsonify(error_response(app_error)), 500
    
    # In development, include more details
    response = error_response(app_error, include_details=True)
    response['error']['debug_info'] = str(error)
    if app.debug:
        response['error']['stack_trace'] = traceback.format_exc()
    
    return jsonify(response), 500

@app.errorhandler(Exception)
def handle_generic_exception(error):
    """Handle any unhandled exceptions"""
    app_error = AppError("An unexpected error occurred")
    app_error.correlation_id = request.correlation_id
    
    # Log the error with full stack trace
    logger.error(f"Unhandled exception: {str(error)}", extra={
        'correlation_id': request.correlation_id,
        'stack_trace': traceback.format_exc(),
        'url': request.url,
        'method': request.method,
        'user_agent': request.headers.get('User-Agent')
    })
    
    # In production, return generic error
    if not app.debug and not app.testing:
        return jsonify(error_response(app_error)), 500
    
    # In development, include error details
    response = error_response(app_error, include_details=True)
    response['error']['debug_info'] = str(error)
    if app.debug:
        response['error']['stack_trace'] = traceback.format_exc()
    
    return jsonify(response), 500

# Async error handler decorator
def async_handler(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        try:
            return f(*args, **kwargs)
        except Exception as e:
            # Convert to AppError if needed
            if not isinstance(e, AppError):
                e = AppError(str(e))
            e.correlation_id = request.correlation_id
            raise e
    return decorated

# Example secure route with error handling
@app.route('/api/users/<user_id>')
@async_handler
def get_user(user_id):
    # Input validation
    if not user_id or len(user_id) != 24:
        raise ValidationError("Invalid user ID format")
    
    try:
        user = User.query.get(user_id)
        
        if not user:
            raise NotFoundError("User")
        
        # Check authorization
        if not has_permission(request.user, 'read', user):
            raise AuthorizationError()
        
        return jsonify({
            'data': {
                'id': user.id,
                'email': user.email,
                'username': user.username
            }
        })
        
    except DatabaseError as e:
        # Handle specific database errors
        logger.error(f"Database error in get_user: {str(e)}", extra={
            'correlation_id': request.correlation_id,
            'user_id': user_id
        })
        raise DatabaseError("Failed to retrieve user")
    
    except Exception as e:
        # Log and re-raise unexpected errors
        logger.error(f"Unexpected error in get_user: {str(e)}", extra={
            'correlation_id': request.correlation_id,
            'user_id': user_id,
            'stack_trace': traceback.format_exc()
        })
        raise

# Example with transaction handling
@app.route('/api/transfer', methods=['POST'])
@async_handler
def transfer_funds():
    data = request.get_json()
    
    # Input validation
    required_fields = ['from_account', 'to_account', 'amount']
    missing_fields = [field for field in required_fields if field not in data]
    
    if missing_fields:
        raise ValidationError("Missing required fields", details={
            'missing_fields': missing_fields
        })
    
    if data['amount'] <= 0:
        raise ValidationError("Amount must be positive")
    
    try:
        # Start database transaction
        db.session.begin()
        
        # Check source account
        from_account = Account.query.get(data['from_account'])
        if not from_account:
            raise NotFoundError("Source account")
        
        # Check destination account
        to_account = Account.query.get(data['to_account'])
        if not to_account:
            raise NotFoundError("Destination account")
        
        # Check sufficient funds
        if from_account.balance < data['amount']:
            raise AppError("Insufficient funds", 400)
        
        # Perform transfer
        from_account.balance -= data['amount']
        to_account.balance += data['amount']
        
        # Create transaction record
        transaction = Transaction(
            from_account_id=data['from_account'],
            to_account_id=data['to_account'],
            amount=data['amount'],
            timestamp=datetime.utcnow()
        )
        
        db.session.add(transaction)
        db.session.commit()
        
        logger.info("Transfer completed successfully", extra={
            'correlation_id': request.correlation_id,
            'transaction_id': transaction.id,
            'amount': data['amount']
        })
        
        return jsonify({
            'message': 'Transfer completed successfully',
            'transaction_id': transaction.id
        })
        
    except Exception as e:
        # Rollback transaction on error
        db.session.rollback()
        
        logger.error(f"Transfer failed: {str(e)}", extra={
            'correlation_id': request.correlation_id,
            'from_account': data['from_account'],
            'to_account': data['to_account'],
            'amount': data['amount']
        })
        
        # Re-raise the error
        if isinstance(e, AppError):
            raise e
        else:
            raise AppError("Transfer failed")
    
    finally:
        # Ensure session is cleaned up
        db.session.remove()

# Security middleware to prevent error leakage
@app.after_request
def secure_headers(response):
    """Add security headers to prevent error information leakage"""
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    
    # Remove server information
    if 'Server' in response.headers:
        del response.headers['Server']
    
    return response

if __name__ == '__main__':
    # Configure production settings
    if not app.debug:
        # Disable detailed error pages in production
        app.config['PROPAGATE_EXCEPTIONS'] = True
        
        # Set up production logging
        logging.getLogger('werkzeug').setLevel(logging.WARNING)
    
    app.run(debug=app.debug)</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="curl-error">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Error Handling Testing with cURL</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-bash">#!/bin/bash
# Comprehensive Error Handling Security Testing

echo "üêõ Testing Error Handling Security"

# Test 1: Test 404 error handling
echo -e "\nüîç Testing 404 error handling..."
curl -i https://api.example.com/api/nonexistent-endpoint

# Test 2: Test validation errors
echo -e "\nüìù Testing validation error handling..."
curl -X POST https://api.example.com/api/users \
  -H "Content-Type: application/json" \
  -d '{
    "email": "invalid-email",
    "password": "123"
  }'

# Test 3: Test authentication errors
echo -e "\nüîê Testing authentication error handling..."
curl -X GET https://api.example.com/api/protected-data

# Test 4: Test authorization errors
echo -e "\nüö´ Testing authorization error handling..."
curl -X GET https://api.example.com/api/admin-data \
  -H "Authorization: Bearer user-token"

# Test 5: Test database errors
echo -e "\nüíæ Testing database error handling..."
curl -X GET "https://api.example.com/api/users/invalid-id-format"

# Test 6: Test malformed JSON
echo -e "\nüìÑ Testing malformed JSON handling..."
curl -X POST https://api.example.com/api/data \
  -H "Content-Type: application/json" \
  -d 'invalid-json-here'

# Test 7: Test large payload handling
echo -e "\nüì¶ Testing large payload handling..."
dd if=/dev/zero bs=1M count=10 | curl -X POST https://api.example.com/api/upload \
  -H "Content-Type: application/octet-stream" \
  --data-binary @-

# Test 8: Test SQL injection error handling
echo -e "\nüíâ Testing SQL injection error handling..."
curl -X GET "https://api.example.com/api/users/1' OR '1'='1"

# Test 9: Test XSS error handling
echo -e "\nüñ•Ô∏è Testing XSS error handling..."
curl -X GET "https://api.example.com/api/search?q=&lt;script&gt;alert('xss attack')&lt;/script&gt;"

# Test 10: Test rate limiting errors
echo -e "\n‚è∞ Testing rate limiting error handling..."
for i in {1..6}; do
  curl -X POST https://api.example.com/api/rate-limited
done

# Test 11: Test CORS error handling
echo -e "\nüåê Testing CORS error handling..."
curl -X OPTIONS https://api.example.com/api/data \
  -H "Origin: http://malicious-site.com" \
  -H "Access-Control-Request-Method: POST"

# Test 12: Test content type validation
echo -e "\nüìã Testing content type validation..."
curl -X POST https://api.example.com/api/users \
  -H "Content-Type: text/plain" \
  -d "plain text data"

# Test 13: Test method not allowed
echo -e "\nüö∑ Testing method not allowed handling..."
curl -X PATCH https://api.example.com/api/users/1

# Test 14: Test request timeout handling
echo -e "\n‚è±Ô∏è Testing timeout handling..."
curl -m 1 https://api.example.com/api/slow-endpoint

# Test 15: Test error response format
echo -e "\nüìä Testing error response format..."
response=$(curl -s https://api.example.com/api/nonexistent)
echo "$response" | jq .

# Check for information leakage
echo -e "\nüîé Checking for information leakage..."
curl -s https://api.example.com/api/error-endpoint | grep -i "stack\|trace\|database\|password\|key"

echo -e "\nüéØ Error handling security testing completed!"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="resource-links">
                    <a href="https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html"
                        target="_blank">
                        <i class="fas fa-external-link-alt"></i> OWASP Error Handling Cheat Sheet
                    </a>
                    <a href="https://12factor.net/logs" target="_blank">
                        <i class="fas fa-external-link-alt"></i> The Twelve-Factor App - Logs
                    </a>
                    <a href="https://docs.python.org/3/library/logging.html" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Python Logging Documentation
                    </a>
                    <a href="https://github.com/winstonjs/winston" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Winston Logging Library
                    </a>
                </div>
            </div>
        </section>

        <!-- Secure Dependencies Section -->
        <section id="secure-dependencies">
            <div class="section-title">
                <h2>Secure Dependencies</h2>
                <p>Manage third-party dependencies securely to prevent supply chain attacks and vulnerabilities.</p>
            </div>

            <div class="topic-card">
                <h3><i class="fas fa-cube"></i> Why Secure Dependency Management is Critical</h3>

                <div class="importance-section">
                    <h4><i class="fas fa-question-circle"></i> What is Secure Dependency Management?</h4>
                    <p>Secure dependency management involves using trusted, well-maintained libraries, keeping them
                        updated, and regularly scanning for vulnerabilities to prevent supply chain attacks.</p>

                    <div class="importance-grid">
                        <div class="importance-item why-important">
                            <h5><i class="fas fa-check-circle"></i> Why It's Important</h5>
                            <ul>
                                <li>Prevents supply chain attacks</li>
                                <li>Reduces attack surface</li>
                                <li>Ensures timely security patches</li>
                                <li>Maintains software integrity</li>
                                <li>Compliance with security standards</li>
                            </ul>
                        </div>

                        <div class="importance-item consequences">
                            <h5><i class="fas fa-exclamation-triangle"></i> Consequences of Ignoring</h5>
                            <ul>
                                <li>Remote code execution vulnerabilities</li>
                                <li>Data breaches through dependencies</li>
                                <li>Malware distribution</li>
                                <li>Legal and compliance violations</li>
                                <li>Reputation damage</li>
                            </ul>
                        </div>

                        <div class="importance-item best-practices">
                            <h5><i class="fas fa-star"></i> Best Practices</h5>
                            <ul>
                                <li>Regular vulnerability scanning</li>
                                <li>Use dependency lock files</li>
                                <li>Implement automated updates</li>
                                <li>Verify package integrity</li>
                                <li>Monitor security advisories</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="incident-example">
                    <h4><i class="fas fa-fire"></i> Real-World Impact: Log4Shell Vulnerability</h4>
                    <p><strong>The Vulnerability:</strong> A critical remote code execution vulnerability
                        (CVE-2021-44228) in the Log4j library affected millions of applications worldwide.</p>
                    <p><strong>The Impact:</strong> Attackers could execute arbitrary code on vulnerable systems,
                        leading to complete system compromise, data theft, and ransomware attacks.</p>
                    <p><strong>The Lesson:</strong> Regular dependency scanning, timely updates, and having an incident
                        response plan for critical vulnerabilities are essential.</p>
                    <a href="https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance"
                        class="incident-link" target="_blank">
                        Read CISA Guidance <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <h4><i class="fas fa-code"></i> Implementation Examples</h4>

                <div class="language-tabs">
                    <div class="lang-tab-buttons">
                        <button class="lang-tab-btn active" data-lang="js">JavaScript</button>
                        <button class="lang-tab-btn" data-lang="python">Python</button>
                        <button class="lang-tab-btn" data-lang="curl">cURL Testing</button>
                    </div>

                    <div class="lang-tab-content active" id="js-deps">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Dependency Management - Node.js</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-json">// package.json - Secure configuration
{
  "name": "secure-node-app",
  "version": "1.0.0",
  "description": "Secure Node.js application with dependency management",
  "type": "module",
  "scripts": {
    "start": "node app.js",
    "dev": "nodemon app.js",
    "test": "jest",
    "security:audit": "npm audit --audit-level=moderate",
    "security:audit:fix": "npm audit fix",
    "security:outdated": "npm outdated",
    "security:update": "npm update",
    "security:check": "npm run security:audit && npm run security:outdated",
    "security:ci": "npm audit --audit-level=high --json",
    "security:snyk": "npx snyk test",
    "security:snyk:monitor": "npx snyk monitor",
    "security:snyk:protect": "npx snyk protect",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "build": "npm run security:check && npm run lint && npm test"
  },
  "dependencies": {
    "express": "^4.18.0",
    "helmet": "^7.0.0",
    "bcrypt": "^5.1.0",
    "jsonwebtoken": "^9.0.0",
    "express-validator": "^7.0.0",
    "express-rate-limit": "^6.7.0",
    "cors": "^2.8.5",
    "compression": "^1.7.4",
    "winston": "^3.8.0",
    "mongoose": "^7.0.0",
    "redis": "^4.6.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.0",
    "jest": "^29.0.0",
    "eslint": "^8.0.0",
    "eslint-config-airbnb-base": "^15.0.0",
    "eslint-plugin-security": "^1.5.0",
    "snyk": "^1.1000.0",
    "npm-audit-resolver": "^3.0.0"
  },
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=9.0.0"
  },
  "keywords": [
    "security",
    "express",
    "authentication",
    "api"
  ],
  "author": "Your Name",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/yourusername/secure-node-app.git"
  }
}</code></pre>
                        </div>

                        <div class="code-block">
                            <div class="code-header">
                                <span>Security Scripts - Node.js</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-javascript">// scripts/security-check.js
import { execSync } from 'child_process';
import fs from 'fs';
import path from 'path';

class SecurityChecker {
    static runSecurityChecks() {
        console.log('üîí Running comprehensive security checks...\n');
        
        try {
            // 1. Check for vulnerable dependencies
            console.log('1. üîç Running npm audit...');
            try {
                execSync('npm audit --audit-level=moderate', { stdio: 'inherit' });
                console.log('‚úÖ No critical vulnerabilities found');
            } catch (error) {
                console.log('‚ùå Vulnerabilities found. Run npm audit fix to resolve.');
            }
            
            // 2. Check for outdated packages
            console.log('\n2. üì¶ Checking for outdated packages...');
            try {
                execSync('npm outdated', { stdio: 'inherit' });
            } catch (error) {
                console.log('‚ö†Ô∏è Some packages are outdated. Consider updating.');
            }
            
            // 3. Run Snyk security test
            console.log('\n3. üõ°Ô∏è Running Snyk security test...');
            try {
                execSync('npx snyk test', { stdio: 'inherit' });
            } catch (error) {
                console.log('‚ùå Snyk found security vulnerabilities');
            }
            
            // 4. Verify package-lock.json integrity
            console.log('\n4. üìÑ Verifying package integrity...');
            if (!fs.existsSync('package-lock.json')) {
                console.log('‚ùå package-lock.json missing. Run npm install to generate it.');
            } else {
                console.log('‚úÖ package-lock.json present');
                
                // Check for known malicious packages
                this.checkForMaliciousPackages();
            }
            
            // 5. Run ESLint security rules
            console.log('\n5. üìù Running security-focused linting...');
            try {
                execSync('npx eslint . --config .eslintrc.security.js', { stdio: 'inherit' });
            } catch (error) {
                console.log('‚ö†Ô∏è Security linting issues found');
            }
            
            // 6. Check for exposed secrets
            console.log('\n6. üîë Checking for exposed secrets...');
            this.checkForExposedSecrets();
            
            console.log('\nüéØ Security checks completed!');
            
        } catch (error) {
            console.error('Error running security checks:', error);
            process.exit(1);
        }
    }
    
    static checkForMaliciousPackages() {
        const knownMalicious = [
            'eslint-config-eslint',
            'eslint-scope',
            'flatmap-stream',
            'rc',
            'crossenv',
            'nodemon-hello'
        ];
        
        const packageJson = JSON.parse(fs.readFileSync('package.json', 'utf8'));
        const allDependencies = {
            ...packageJson.dependencies,
            ...packageJson.devDependencies
        };
        
        const found = Object.keys(allDependencies).filter(dep => 
            knownMalicious.includes(dep)
        );
        
        if (found.length > 0) {
            console.log(`‚ùå Found potentially malicious packages: ${found.join(', ')}`);
        } else {
            console.log('‚úÖ No known malicious packages found');
        }
    }
    
    static checkForExposedSecrets() {
        const secretsPatterns = [
            /password\s*=\s*['"][^'"]+['"]/gi,
            /api[_-]?key\s*=\s*['"][^'"]+['"]/gi,
            /secret[_-]?key\s*=\s*['"][^'"]+['"]/gi,
            /aws[_-]?access[_-]?key\s*=\s*['"][^'"]+['"]/gi,
            /aws[_-]?secret[_-]?key\s*=\s*['"][^'"]+['"]/gi,
            /database[_-]?url\s*=\s*['"][^'"]+['"]/gi
        ];
        
        let foundSecrets = false;
        
        function scanDirectory(dir) {
            const files = fs.readdirSync(dir);
            
            for (const file of files) {
                const filePath = path.join(dir, file);
                const stat = fs.statSync(filePath);
                
                if (stat.isDirectory() && file !== 'node_modules' && !file.startsWith('.')) {
                    scanDirectory(filePath);
                } else if (stat.isFile() && /\.(js|json|env|config)$/.test(file)) {
                    try {
                        const content = fs.readFileSync(filePath, 'utf8');
                        
                        for (const pattern of secretsPatterns) {
                            if (pattern.test(content)) {
                                console.log(`‚ùå Potential secret found in ${filePath}`);
                                foundSecrets = true;
                            }
                        }
                    } catch (error) {
                        // Skip binary files
                    }
                }
            }
        }
        
        scanDirectory('.');
        
        if (!foundSecrets) {
            console.log('‚úÖ No exposed secrets found');
        }
    }
}

// Run if this script is executed directly
if (import.meta.url === `file://${process.argv[1]}`) {
    SecurityChecker.runSecurityChecks();
}

export default SecurityChecker;</code></pre>
                        </div>

                        <div class="code-block">
                            <div class="code-header">
                                <span>ESLint Security Configuration</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-json">// .eslintrc.security.js
module.exports = {
    extends: [
        'eslint:recommended',
        'plugin:security/recommended'
    ],
    plugins: [
        'security'
    ],
    env: {
        node: true,
        es2022: true
    },
    parserOptions: {
        ecmaVersion: 2022,
        sourceType: 'module'
    },
    rules: {
        // Security-specific rules
        'security/detect-buffer-noassert': 'error',
        'security/detect-child-process': 'error',
        'security/detect-disable-mustache-escape': 'error',
        'security/detect-eval-with-expression': 'error',
        'security/detect-new-buffer': 'error',
        'security/detect-no-csrf-before-method-override': 'error',
        'security/detect-non-literal-fs-filename': 'warn',
        'security/detect-non-literal-regexp': 'error',
        'security/detect-non-literal-require': 'warn',
        'security/detect-object-injection': 'warn',
        'security/detect-possible-timing-attacks': 'error',
        'security/detect-pseudoRandomBytes': 'error',
        'security/detect-unsafe-regex': 'error',
        
        // General security best practices
        'no-eval': 'error',
        'no-implied-eval': 'error',
        'no-new-func': 'error',
        'no-script-url': 'error',
        'no-unsanitized/method': 'error',
        'no-unsanitized/property': 'error'
    }
};

// .eslintrc.js (main configuration)
module.exports = {
    extends: [
        'airbnb-base',
        './.eslintrc.security.js'
    ],
    rules: {
        // Additional project-specific rules
        'no-console': 'warn',
        'import/no-unresolved': 'error',
        'import/extensions': ['error', 'ignorePackages']
    }
};</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="python-deps">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Secure Dependency Management - Python</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python"># requirements.txt - Secure Python dependencies
# Pinned versions for security and reproducibility
# Core dependencies
Flask==2.3.0
Werkzeug==2.3.0
Jinja2==3.1.0

# Security libraries
bcrypt==4.0.0
PyJWT==2.7.0
cryptography==41.0.0
bleach==6.0.0

# Database
SQLAlchemy==2.0.0
psycopg2-binary==2.9.0
redis==4.5.0

# API and web
requests==2.31.0
gunicorn==21.0.0

# Monitoring and logging
structlog==23.1.0
sentry-sdk==1.25.0

# requirements-dev.txt
-r requirements.txt

# Development and testing
pytest==7.3.0
pytest-cov==4.1.0
black==23.0.0
flake8==6.0.0
mypy==1.4.0
bandit==1.7.0
safety==2.3.0
pre-commit==3.3.0

# requirements-test.txt
-r requirements.txt
-r requirements-dev.txt

pytest==7.3.0
pytest-mock==3.10.0
pytest-asyncio==0.21.0
Faker==18.0.0

# setup.py for package distribution
from setuptools import setup, find_packages

with open("README.md", "r", encoding="utf-8") as fh:
    long_description = fh.read()

with open("requirements.txt", "r", encoding="utf-8") as fh:
    requirements = [line.strip() for line in fh if line.strip() and not line.startswith("#")]

setup(
    name="secure-flask-app",
    version="1.0.0",
    author="Your Name",
    author_email="your.email@example.com",
    description="A secure Flask application with proper dependency management",
    long_description=long_description,
    long_description_content_type="text/markdown",
    packages=find_packages(),
    classifiers=[
        "Development Status :: 4 - Beta",
        "Intended Audience :: Developers",
        "License :: OSI Approved :: MIT License",
        "Operating System :: OS Independent",
        "Programming Language :: Python :: 3",
        "Programming Language :: Python :: 3.8",
        "Programming Language :: Python :: 3.9",
        "Programming Language :: Python :: 3.10",
        "Programming Language :: Python :: 3.11",
        "Topic :: Security",
    ],
    python_requires=">=3.8",
    install_requires=requirements,
    extras_require={
        "dev": [
            "black>=23.0.0",
            "flake8>=6.0.0",
            "mypy>=1.4.0",
            "bandit>=1.7.0",
            "safety>=2.3.0",
            "pytest>=7.3.0",
        ],
        "postgres": ["psycopg2-binary>=2.9.0"],
        "redis": ["redis>=4.5.0"],
    },
    entry_points={
        "console_scripts": [
            "secure-app=app.cli:main",
        ],
    },
)</code></pre>
                        </div>

                        <div class="code-block">
                            <div class="code-header">
                                <span>Security Scripts - Python</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-python">#!/usr/bin/env python3
# scripts/security_check.py

import subprocess
import sys
import os
import json
import requests
from pathlib import Path

class SecurityChecker:
    def __init__(self):
        self.failed_checks = 0
        
    def run_security_checks(self):
        """Run comprehensive security checks"""
        print("üîí Running Python Security Checks\n")
        
        checks = [
            self.check_vulnerable_dependencies,
            self.check_outdated_packages,
            self.run_bandit_scan,
            self.check_security_headers,
            self.verify_requirements_files,
            self.check_for_exposed_secrets,
            self.verify_dependency_integrity
        ]
        
        for check in checks:
            try:
                check()
            except Exception as e:
                print(f"‚ùå Check failed: {e}")
                self.failed_checks += 1
        
        print(f"\nüéØ Security checks completed. Failures: {self.failed_checks}")
        return self.failed_checks == 0
    
    def check_vulnerable_dependencies(self):
        """Check for vulnerable dependencies using Safety"""
        print("1. üîç Checking for vulnerable dependencies with Safety...")
        try:
            result = subprocess.run([
                sys.executable, "-m", "safety", "check", 
                "-r", "requirements.txt", "--json"
            ], capture_output=True, text=True, check=True)
            
            vulnerabilities = json.loads(result.stdout)
            
            if vulnerabilities:
                print("‚ùå Found vulnerable dependencies:")
                for vuln in vulnerabilities:
                    print(f"   - {vuln.get('package_name')}: {vuln.get('advisory')}")
                self.failed_checks += 1
            else:
                print("‚úÖ No vulnerable dependencies found")
                
        except subprocess.CalledProcessError:
            print("‚ùå Safety check failed")
            self.failed_checks += 1
        except FileNotFoundError:
            print("‚ö†Ô∏è Safety not installed. Install with: pip install safety")
    
    def check_outdated_packages(self):
        """Check for outdated packages"""
        print("\n2. üì¶ Checking for outdated packages...")
        try:
            result = subprocess.run([
                sys.executable, "-m", "pip", "list", "--outdated", "--format=json"
            ], capture_output=True, text=True, check=True)
            
            outdated = json.loads(result.stdout)
            
            if outdated:
                print("‚ö†Ô∏è Outdated packages found:")
                for pkg in outdated:
                    print(f"   - {pkg['name']}: {pkg['version']} -> {pkg['latest_version']}")
            else:
                print("‚úÖ All packages are up to date")
                
        except subprocess.CalledProcessError:
            print("‚ùå Failed to check outdated packages")
            self.failed_checks += 1
    
    def run_bandit_scan(self):
        """Run Bandit security scan"""
        print("\n3. üõ°Ô∏è Running Bandit security scan...")
        try:
            result = subprocess.run([
                sys.executable, "-m", "bandit", "-r", ".", 
                "-f", "json", "-o", "bandit_report.json"
            ], capture_output=True, text=True)
            
            if result.returncode != 0:
                with open('bandit_report.json', 'r') as f:
                    report = json.load(f)
                
                issues = report.get('metrics', {}).get('_totals', {}).get('issues', 0)
                if issues > 0:
                    print(f"‚ùå Bandit found {issues} security issues")
                    self.failed_checks += 1
                else:
                    print("‚úÖ No security issues found by Bandit")
            else:
                print("‚úÖ Bandit scan completed successfully")
                
        except FileNotFoundError:
            print("‚ö†Ô∏è Bandit not installed. Install with: pip install bandit")
    
    def check_security_headers(self):
        """Check for security-related headers in requirements"""
        print("\n4. üìã Checking security headers in requirements...")
        requirements_file = Path("requirements.txt")
        
        if requirements_file.exists():
            content = requirements_file.read_text()
            
            # Check for insecure packages
            insecure_packages = {
                'pycrypto': 'Use cryptography instead',
                'md5': 'Use hashlib instead',
                'sha1': 'Use hashlib with stronger algorithms'
            }
            
            for pkg, recommendation in insecure_packages.items():
                if pkg in content:
                    print(f"‚ùå Insecure package found: {pkg}. Recommendation: {recommendation}")
                    self.failed_checks += 1
            
            print("‚úÖ Requirements security check completed")
        else:
            print("‚ö†Ô∏è requirements.txt not found")
    
    def verify_requirements_files(self):
        """Verify requirements files exist and are properly formatted"""
        print("\n5. üìÑ Verifying requirements files...")
        
        required_files = ['requirements.txt', 'requirements-dev.txt']
        
        for file in required_files:
            if Path(file).exists():
                print(f"‚úÖ {file} present")
            else:
                print(f"‚ùå {file} missing")
                self.failed_checks += 1
        
        # Check for unpinned dependencies
        if Path("requirements.txt").exists():
            with open("requirements.txt", "r") as f:
                for line_num, line in enumerate(f, 1):
                    line = line.strip()
                    if line and not line.startswith("#"):
                        if "==" not in line and line not in ["-r requirements.txt"]:
                            print(f"‚ùå Unpinned dependency found in requirements.txt line {line_num}: {line}")
                            self.failed_checks += 1
    
    def check_for_exposed_secrets(self):
        """Check for exposed secrets in code"""
        print("\n6. üîë Checking for exposed secrets...")
        
        secret_patterns = [
            r'password\s*=\s*[\'"][^\'"]+[\'"]',
            r'api[_-]?key\s*=\s*[\'"][^\'"]+[\'"]',
            r'secret[_-]?key\s*=\s*[\'"][^\'"]+[\'"]',
            r'aws[_-]?access[_-]?key\s*=\s*[\'"][^\'"]+[\'"]',
            r'aws[_-]?secret[_-]?key\s*=\s*[\'"][^\'"]+[\'"]',
            r'database[_-]?url\s*=\s*[\'"][^\'"]+[\'"]'
        ]
        
        found_secrets = False
        
        for file_path in Path('.').rglob('*.py'):
            try:
                content = file_path.read_text()
                for pattern in secret_patterns:
                    if re.search(pattern, content, re.IGNORECASE):
                        print(f"‚ùå Potential secret found in {file_path}")
                        found_secrets = True
                        self.failed_checks += 1
            except Exception:
                continue
        
        if not found_secrets:
            print("‚úÖ No exposed secrets found")
    
    def verify_dependency_integrity(self):
        """Verify dependency integrity using hash checking"""
        print("\n7. üîí Verifying dependency integrity...")
        try:
            # Generate requirements with hashes
            result = subprocess.run([
                sys.executable, "-m", "pip", "hash", "-r", "requirements.txt"
            ], capture_output=True, text=True, check=True)
            
            print("‚úÖ Dependency integrity verification completed")
            
        except subprocess.CalledProcessError:
            print("‚ö†Ô∏è Dependency integrity check failed")
            self.failed_checks += 1

if __name__ == "__main__":
    checker = SecurityChecker()
    success = checker.run_security_checks()
    sys.exit(0 if success else 1)</code></pre>
                        </div>

                        <div class="code-block">
                            <div class="code-header">
                                <span>pre-commit Configuration</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-yaml"># .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: check-merge-conflict
      - id: check-ast
      - id: check-json
      - id: check-toml
      - id: detect-private-key

  - repo: https://github.com/psf/black
    rev: 23.1.0
    hooks:
      - id: black
        language_version: python3

  - repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
        additional_dependencies: [flake8-bandit]

  - repo: https://github.com/pycqa/bandit
    rev: 1.7.4
    hooks:
      - id: bandit
        args: ["-c", "pyproject.toml"]

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.0.0
    hooks:
      - id: mypy
        additional_dependencies: [types-requests]

  - repo: local
    hooks:
      - id: security-check
        name: Security Check
        entry: python scripts/security_check.py
        language: system
        pass_filenames: false
        always_run: true

  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']

# pyproject.toml for Bandit configuration
[tool.bandit]
exclude_dirs = ['tests', 'venv', 'virtualenv']
skips = ['B101', 'B104']

[tool.black]
line-length = 88
target-version = ['py38']

[tool.isort]
profile = 'black'
multi_line_output = 3

[tool.mypy]
python_version = "3.8"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true</code></pre>
                        </div>
                    </div>

                    <div class="lang-tab-content" id="curl-deps">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Dependency Security Testing with cURL</span>
                                <span class="badge secure">SECURE</span>
                            </div>
                            <pre><code class="language-bash">#!/bin/bash
# Comprehensive Dependency Security Testing Script

echo "üì¶ Running Dependency Security Tests"

# Function to check command availability
check_command() {
    if ! command -v $1 &> /dev/null; then
        echo "‚ùå $1 is not installed. Please install it first."
        return 1
    fi
    return 0
}

# Test 1: Check for Node.js project and run security audit
if [ -f "package.json" ]; then
    echo -e "\n1. üîç Checking Node.js dependencies..."
    
    # Check for package-lock.json
    if [ ! -f "package-lock.json" ]; then
        echo "‚ùå package-lock.json missing. Run npm install to generate it."
    else
        echo "‚úÖ package-lock.json present"
    fi
    
    # Run npm audit
    echo -e "\nüìä Running npm audit..."
    npm audit --audit-level=moderate
    
    # Check for outdated packages
    echo -e "\nüîÑ Checking for outdated packages..."
    npm outdated || echo "‚ö†Ô∏è Some packages are outdated"
    
    # Run Snyk test if available
    if check_command npx; then
        echo -e "\nüõ°Ô∏è Running Snyk security test..."
        npx snyk test || echo "‚ö†Ô∏è Snyk found vulnerabilities"
    fi
    
    # Check for known malicious packages
    echo -e "\nüö´ Scanning for known malicious packages..."
    npx npm-audit-resolver || echo "‚ö†Ô∏è Run npm audit fix to resolve issues"
fi

# Test 2: Check for Python project and run security checks
if [ -f "requirements.txt" ] || [ -f "Pipfile" ] || [ -f "pyproject.toml" ]; then
    echo -e "\n2. üêç Checking Python dependencies..."
    
    # Check for virtual environment
    if [ -d "venv" ] || [ -d ".venv" ]; then
        echo "‚úÖ Virtual environment detected"
    else
        echo "‚ö†Ô∏è No virtual environment detected. Consider using one."
    fi
    
    # Run Safety check
    if check_command safety; then
        echo -e "\nüîç Running Safety vulnerability check..."
        safety check -r requirements.txt || echo "‚ùå Safety found vulnerabilities"
    else
        echo "‚ö†Ô∏è Safety not installed. Install with: pip install safety"
    fi
    
    # Run Bandit security scan
    if check_command bandit; then
        echo -e "\nüõ°Ô∏è Running Bandit security scan..."
        bandit -r . -f json -o bandit_report.json || echo "‚ö†Ô∏è Bandit found security issues"
    else
        echo "‚ö†Ô∏è Bandit not installed. Install with: pip install bandit"
    fi
    
    # Check for outdated packages
    if check_command pip; then
        echo -e "\nüîÑ Checking for outdated packages..."
        pip list --outdated || echo "‚ö†Ô∏è Some packages are outdated"
    fi
fi

# Test 3: Check for system dependencies
echo -e "\n3. üíª Checking system dependencies..."
if check_command dpkg; then
    echo -e "\nüìã Checking for system security updates..."
    sudo apt list --upgradable 2>/dev/null | head -10
fi

# Test 4: Check Docker security
if [ -f "Dockerfile" ]; then
    echo -e "\n4. üê≥ Checking Docker security..."
    
    # Check for known vulnerabilities in base image
    if check_command docker; then
        echo -e "\nüîç Scanning Docker image for vulnerabilities..."
        # This would typically use tools like Trivix or Docker Scout
        echo "‚ö†Ô∏è Consider running: docker scan your-image-name"
    fi
    
    # Check Dockerfile security best practices
    echo -e "\nüìù Checking Dockerfile security..."
    if grep -q "USER root" Dockerfile && ! grep -q "USER" Dockerfile | tail -1 | grep -q "USER"; then
        echo "‚ùå Dockerfile runs as root. Consider adding a non-root user."
    fi
    
    if grep -q "apt-get update && apt-get install" Dockerfile; then
        echo "‚úÖ Dockerfile properly combines apt-get update and install"
    fi
fi

# Test 5: Check for exposed secrets
echo -e "\n5. üîë Checking for exposed secrets..."
if check_command git; then
    echo -e "\nüîç Scanning for secrets in git history..."
    git log -p | grep -i "password\|secret\|key" | head -5
fi

# Check current directory for common secret files
echo -e "\nüìÅ Checking for secret files..."
find . -name "*.env" -o -name ".env*" -o -name "*.key" -o -name "*.pem" | head -10

# Test 6: Check file permissions
echo -e "\n6. üìÅ Checking file permissions..."
find . -name "*.py" -perm /o+w -ls | head -5
find . -name "*.js" -perm /o+w -ls | head -5

# Test 7: Check for vulnerable services
echo -e "\n7. üåê Checking for vulnerable services..."
if check_command nmap; then
    echo -e "\nüîç Scanning for open ports..."
    nmap localhost -p 80,443,3000,5000,5432,6379
fi

# Test 8: SSL/TLS configuration check
echo -e "\n8. üîí Checking SSL/TLS configuration..."
if check_command openssl; then
    echo -e "\nüìú Testing SSL certificate..."
    openssl s_client -connect localhost:443 -servername localhost < /dev/null 2>/dev/null | openssl x509 -noout -dates
fi

# Test 9: Dependency vulnerability databases
echo -e "\n9. üìö Checking vulnerability databases..."
echo -e "\nüîó Useful resources:"
echo "   - National Vulnerability Database: https://nvd.nist.gov"
echo "   - GitHub Security Advisories: https://github.com/advisories"
echo "   - Snyk Vulnerability DB: https://snyk.io/vuln"

# Test 10: Generate security report
echo -e "\n10. üìä Generating security report..."
{
    echo "Security Assessment Report"
    echo "=========================="
    date
    echo
    echo "Dependencies:"
    if [ -f "package.json" ]; then
        echo "- Node.js project detected"
        npm list --depth=0
    fi
    if [ -f "requirements.txt" ]; then
        echo "- Python project detected"
        pip list
    fi
    echo
    echo "Recommendations:"
    echo "- Regularly update dependencies"
    echo "- Use automated security scanning"
    echo "- Implement dependency pinning"
    echo "- Monitor security advisories"
} > security_report.txt

echo -e "\n‚úÖ Security report generated: security_report.txt"
echo -e "\nüéØ Dependency security testing completed!"

# Summary
echo -e "\nüìã SECURITY SUMMARY:"
echo "==================="
echo "‚úÖ Checked for vulnerable dependencies"
echo "‚úÖ Scanned for security issues"
echo "‚úÖ Verified file permissions"
echo "‚úÖ Checked for exposed secrets"
echo "‚úÖ Generated security report"
echo
echo "üîß Next steps:"
echo "   - Review and fix identified issues"
echo "   - Set up automated security scanning"
echo "   - Monitor dependencies regularly"
echo "   - Keep security tools updated"</code></pre>
                        </div>
                    </div>
                </div>

                <div class="resource-links">
                    <a href="https://snyk.io/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Snyk - Vulnerability Scanner
                    </a>
                    <a href="https://pyup.io/safety/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Safety - Python Security Check
                    </a>
                    <a href="https://github.com/PyCQA/bandit" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Bandit - Python AST Security Scanner
                    </a>
                    <a href="https://owasp.org/www-project-dependency-check/" target="_blank">
                        <i class="fas fa-external-link-alt"></i> OWASP Dependency Check
                    </a>
                    <a href="https://github.com/pre-commit/pre-commit" target="_blank">
                        <i class="fas fa-external-link-alt"></i> pre-commit - Git Hooks
                    </a>
                </div>
            </div>
        </section>

        <!-- Resources Section -->
        <section id="resources">
            <div class="section-title">
                <h2>Learning Resources & References</h2>
                <p>Comprehensive collection of security resources, tools, and references to master secure coding
                    practices.</p>
            </div>

            <div class="resources-grid">
                <div class="resource-card">
                    <h3><i class="fab fa-osi"></i> OWASP Resources</h3>
                    <p>The Open Web Application Security Project provides free, open-source resources for web
                        application security including the OWASP Top 10 and cheat sheets.</p>
                    <a href="https://owasp.org" class="resource-link" target="_blank">
                        Visit OWASP <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <div class="resource-card">
                    <h3><i class="fas fa-book"></i> Secure Coding Books</h3>
                    <p>Recommended books for deep diving into secure software development practices and understanding
                        security fundamentals.</p>
                    <a href="https://www.amazon.com/Secure-Coding-Principles-Practices-Donald/dp/0596002424"
                        class="resource-link" target="_blank">
                        View Books <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <div class="resource-card">
                    <h3><i class="fas fa-tools"></i> Security Tools</h3>
                    <p>Essential tools for testing and improving your application security including SAST, DAST, and
                        dependency scanning tools.</p>
                    <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools" class="resource-link"
                        target="_blank">
                        Explore Tools <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <div class="resource-card">
                    <h3><i class="fas fa-graduation-cap"></i> Online Courses</h3>
                    <p>Structured learning paths for application security and secure coding from reputable platforms and
                        security experts.</p>
                    <a href="https://www.coursera.org/specializations/secure-software-design" class="resource-link"
                        target="_blank">
                        Find Courses <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <div class="resource-card">
                    <h3><i class="fas fa-bug"></i> Vulnerability Databases</h3>
                    <p>Stay updated with the latest security vulnerabilities, patches, and security advisories from
                        official sources.</p>
                    <a href="https://cve.mitre.org" class="resource-link" target="_blank">
                        CVE Database <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

                <div class="resource-card">
                    <h3><i class="fab fa-node-js"></i> Node.js Security</h3>
                    <p>Node.js specific security best practices, vulnerable packages, and security guidelines for
                        JavaScript developers.</p>
                    <a href="https://nodejs.org/en/docs/guides/security/" class="resource-link" target="_blank">
                        Node.js Security <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>

            <div class="section-title" style="margin-top: 4rem;">
                <h2>Connect & Learn More</h2>
                <p>Join our community of security-conscious developers and continue learning together</p>
            </div>

            <div class="topic-card" style="text-align: center;">
                <h3><i class="fas fa-users"></i> Join the Security Community</h3>
                <p>Connect with me on various platforms for more security content, tutorials, and discussions.</p>

                <div class="social-links" style="justify-content: center; margin: 2rem 0;">
                    <a href="https://github.com/ritikraj07" class="social-link" target="_blank" title="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://www.youtube.com/@Beer-with-Bugs" class="social-link" target="_blank"
                        title="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="https://www.instagram.com/dev_ritik07/" class="social-link" target="_blank"
                        title="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/ritik-raj07/" class="social-link" target="_blank"
                        title="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="mailto:imritikraj0@gmail.com" class="social-link" target="_blank" title="Email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>

                <div style="margin: 2rem 0;">
                    <a href="https://www.youtube.com/@Beer-with-Bugs" class="youtube-btn"
                        style="font-size: 1.3rem; padding: 1.2rem 2.5rem;" target="_blank">
                        <i class="fab fa-youtube"></i> Subscribe to My YouTube Channel
                    </a>
                </div>

                <p><strong>Weekly content on:</strong></p>
                <div style="columns: 2; list-style: none; margin: 1.5rem 0; text-align: left;">
                    <ul style="list-style: none;">
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Secure Coding Practices</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Web Application Security</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Bug Bounty Hunting</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Penetration Testing</li>
                    </ul>
                    <ul style="list-style: none;">
                        <li><i class="fas fa-check" style="color: var(--success);"></i> API Security</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> DevSecOps</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Cloud Security</li>
                        <li><i class="fas fa-check" style="color: var(--success);"></i> Career Guidance</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Secure Coding Guide</h3>
                    <p>Your comprehensive resource for learning secure software development practices and protecting
                        your applications from cyber threats. Created with ‚ù§Ô∏è by Ritik Raj.</p>
                    <div class="social-links">
                        <a href="https://github.com/ritikraj07" class="social-link" target="_blank">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://www.youtube.com/@Beer-with-Bugs" class="social-link" target="_blank">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/dev_ritik07/" class="social-link" target="_blank">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/ritik-raj07/" class="social-link" target="_blank">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </div>
                </div>

                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" data-target="overview">Overview</a></li>
                        <li><a href="#" data-target="input-validation">Input Validation</a></li>
                        <li><a href="#" data-target="secure-communication">Secure Communication</a></li>
                        <li><a href="#" data-target="authentication">Authentication</a></li>
                        <li><a href="#" data-target="error-handling">Error Handling</a></li>
                        <li><a href="#" data-target="secure-dependencies">Secure Dependencies</a></li>
                        <li><a href="#" data-target="resources">Resources</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h3>External Resources</h3>
                    <ul class="footer-links">
                        <li><a href="https://owasp.org" target="_blank">OWASP Foundation</a></li>
                        <li><a href="https://www.sans.org/top25-software-errors/" target="_blank">SANS Top 25</a></li>
                        <li><a href="https://cheatsheetseries.owasp.org/" target="_blank">OWASP Cheat Sheets</a></li>
                        <li><a href="https://cve.mitre.org" target="_blank">CVE Database</a></li>
                        <li><a href="https://www.wiz.io/academy/secure-coding-best-practices" target="_blank">Wiz
                                Academy</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h3>Contact & Support</h3>
                    <ul class="footer-links">
                        <li><a href="mailto:imritikraj0@gmail.com"><i class="fas fa-envelope"></i> Email:
                                imritikraj0@gmail.com</a></li>
                        <li><a href="https://github.com/ritikraj07" target="_blank"><i class="fab fa-github"></i>
                                GitHub</a></li>
                        <li><a href="https://www.linkedin.com/in/ritik-raj07/" target="_blank"><i
                                    class="fab fa-linkedin"></i> LinkedIn</a></li>
                        <li><a href="https://www.youtube.com/@Beer-with-Bugs" target="_blank"><i
                                    class="fab fa-youtube"></i> YouTube</a></li>
                    </ul>
                </div>
            </div>

            <div class="copyright">
                <p>&copy; 2025 Secure Coding Practices Guide. All rights reserved. | Created by Ritik Raj | ritik07 |
                    lord ritik | lord_ritik07</p>
            </div>
        </div>
    </footer>

    <!-- Progress Tracker -->
    <div class="progress-tracker" id="progressTracker">
        <h4>Security Topics</h4>
        <div class="progress-items">
            <div class="progress-item active" data-target="overview">
                <i class="fas fa-home"></i>
                <span>Overview</span>
            </div>
            <div class="progress-item" data-target="input-validation">
                <i class="fas fa-filter"></i>
                <span>Input Validation</span>
            </div>
            <div class="progress-item" data-target="secure-communication">
                <i class="fas fa-lock"></i>
                <span>Secure Communication</span>
            </div>
            <div class="progress-item" data-target="authentication">
                <i class="fas fa-key"></i>
                <span>Authentication</span>
            </div>
            <div class="progress-item" data-target="error-handling">
                <i class="fas fa-bug"></i>
                <span>Error Handling</span>
            </div>
            <div class="progress-item" data-target="secure-dependencies">
                <i class="fas fa-cube"></i>
                <span>Secure Dependencies</span>
            </div>
            <div class="progress-item" data-target="resources">
                <i class="fas fa-book"></i>
                <span>Resources</span>
            </div>
        </div>
    </div>

    <!-- Back to top button -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

   <script>
    hljs.configure({
            escapeHTML: true,  // This is the key security setting
            throwUnescapedHTML: false // Prevents console warnings but still escapes
        });

        // Initialize syntax highlighting with security
        hljs.highlightAll();

        // Security helper functions
        function escapeHTML(unsafe) {
            if (!unsafe) return '';
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
    // Initialize syntax highlighting
    hljs.highlightAll();

    // Security helper functions
    function escapeHTML(unsafe) {
        if (!unsafe) return '';
        return unsafe
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    // Safe text highlighting without innerHTML
    function safeHighlightText(element, searchTerm) {
        const originalText = element.textContent;
        const escapedTerm = escapeRegex(searchTerm);
        const regex = new RegExp(`(${escapedTerm})`, 'gi');
        
        // Clear the element
        element.textContent = '';
        
        // Split text and create marked elements safely
        const parts = originalText.split(regex);
        
        parts.forEach(part => {
            if (regex.test(part)) {
                const mark = document.createElement('mark');
                mark.textContent = part;
                element.appendChild(mark);
            } else {
                element.appendChild(document.createTextNode(part));
            }
        });
    }

    // Navigation functionality
    function navigateToSection(targetId) {
        // Remove active class from all nav items
        document.querySelectorAll('.nav-item').forEach(nav => {
            nav.classList.remove('active');
        });

        // Add active class to clicked nav item
        const correspondingNav = document.querySelector(`.nav-item[data-target="${targetId}"]`);
        if (correspondingNav) {
            correspondingNav.classList.add('active');
        }

        // Update progress tracker
        document.querySelectorAll('.progress-item').forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('data-target') === targetId) {
                item.classList.add('active');
            }
        });

        // Hide all sections
        document.querySelectorAll('section').forEach(section => {
            section.classList.remove('active');
        });

        // Show target section
        document.getElementById(targetId).classList.add('active');

        // Re-highlight code in the new section
        setTimeout(() => {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        }, 100);

        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // Update URL without page reload
        history.pushState(null, null, `#${targetId}`);
    }

    // Set up navigation event listeners
    document.querySelectorAll('.nav-item, .footer-links a, .progress-item').forEach(item => {
        item.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('data-target');
            if (targetId) {
                navigateToSection(targetId);
            }
        });
    });

    // Language tab functionality
    document.querySelectorAll('.lang-tab-btn').forEach(button => {
        button.addEventListener('click', function () {
            const lang = this.getAttribute('data-lang');
            const tabContainer = this.closest('.language-tabs');
            const sectionId = tabContainer.closest('section').id;

            // Remove active class from all buttons in this container
            tabContainer.querySelectorAll('.lang-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Add active class to clicked button
            this.classList.add('active');

            // Hide all language content in this container
            tabContainer.querySelectorAll('.lang-tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Show target language content
            const targetId = `${lang}-${sectionId.split('-')[0]}`;
            document.getElementById(targetId).classList.add('active');

            // Re-highlight code
            setTimeout(() => {
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            }, 100);
        });
    });

    // Back to top button functionality
    const backToTopButton = document.getElementById('backToTop');
    const progressTracker = document.getElementById('progressTracker');

    window.addEventListener('scroll', () => {
        // Show/hide back to top button
        if (window.pageYOffset > 300) {
            backToTopButton.classList.add('visible');
        } else {
            backToTopButton.classList.remove('visible');
        }

        // Show/hide progress tracker
        if (window.pageYOffset > 500 && window.innerWidth > 1024) {
            progressTracker.classList.add('visible');
        } else {
            progressTracker.classList.remove('visible');
        }

        // Update active section in progress tracker based on scroll position
        const sections = document.querySelectorAll('section');
        let currentSection = '';

        sections.forEach(section => {
            const sectionTop = section.offsetTop - 100;
            if (window.pageYOffset >= sectionTop) {
                currentSection = section.id;
            }
        });

        if (currentSection) {
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-target') === currentSection) {
                    item.classList.add('active');
                }
            });
        }
    });

    backToTopButton.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    // SECURE Search functionality - XSS FIXED
    const searchInput = document.getElementById('searchInput');
    let searchTimeout;

    searchInput.addEventListener('input', function () {
        clearTimeout(searchTimeout);
        const searchTerm = this.value.toLowerCase().trim();

        if (searchTerm.length < 2) {
            // Show all cards if search term is too short
            document.querySelectorAll('.topic-card').forEach(card => {
                card.style.display = 'block';
                // Reset any previous highlighting
                const title = card.querySelector('h3');
                if (title) {
                    const originalText = title.getAttribute('data-original-text') || title.textContent;
                    title.textContent = originalText;
                }
            });
            
            // Remove any existing results message
            const existingMessage = document.getElementById('searchResultsMessage');
            if (existingMessage) {
                existingMessage.remove();
            }
            return;
        }

        searchTimeout = setTimeout(() => {
            let foundResults = false;

            document.querySelectorAll('.topic-card').forEach(card => {
                const cardText = card.textContent.toLowerCase();
                if (cardText.includes(searchTerm)) {
                    card.style.display = 'block';
                    foundResults = true;

                    // SAFE: Highlight matching text without innerHTML
                    const title = card.querySelector('h3');
                    if (title) {
                        // Store original text if not already stored
                        if (!title.hasAttribute('data-original-text')) {
                            title.setAttribute('data-original-text', title.textContent);
                        }
                        
                        const originalText = title.getAttribute('data-original-text');
                        safeHighlightText(title, searchTerm);
                    }
                } else {
                    card.style.display = 'none';
                    // Reset highlighting for hidden cards
                    const title = card.querySelector('h3');
                    if (title && title.hasAttribute('data-original-text')) {
                        title.textContent = title.getAttribute('data-original-text');
                    }
                }
            });

            // Show message if no results found
            const resultsMessage = document.getElementById('searchResultsMessage') ||
                document.createElement('div');
            resultsMessage.id = 'searchResultsMessage';
            resultsMessage.style.padding = '2rem';
            resultsMessage.style.textAlign = 'center';
            resultsMessage.style.color = 'var(--gray)';

            if (!foundResults && searchTerm.length >= 2) {
                resultsMessage.textContent = `No results found for "${escapeHTML(searchTerm)}". Try different keywords.`;
                if (!document.getElementById('searchResultsMessage')) {
                    document.querySelector('main').appendChild(resultsMessage);
                }
            } else {
                if (document.getElementById('searchResultsMessage')) {
                    document.getElementById('searchResultsMessage').remove();
                }
            }
        }, 300);
    });

    // Handle browser back/forward buttons
    window.addEventListener('popstate', function () {
        const hash = window.location.hash.substring(1);
        if (hash) {
            navigateToSection(hash);
        }
    });

    // Initialize based on URL hash
    if (window.location.hash) {
        const targetId = window.location.hash.substring(1);
        navigateToSection(targetId);
    }

    // Add loading animation for better UX
    window.addEventListener('load', function () {
        document.body.style.opacity = '0';
        document.body.style.transition = 'opacity 0.3s ease';

        setTimeout(() => {
            document.body.style.opacity = '1';
        }, 100);
    });

    // Enhanced code copy functionality
    document.addEventListener('click', function (e) {
        if (e.target.closest('.code-header')) {
            const codeBlock = e.target.closest('.code-block');
            const code = codeBlock.querySelector('code').textContent;

            navigator.clipboard.writeText(code).then(() => {
                const originalText = e.target.closest('.code-header').querySelector('span').textContent;
                e.target.closest('.code-header').querySelector('span').textContent = 'Copied!';

                setTimeout(() => {
                    e.target.closest('.code-header').querySelector('span').textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy code: ', err);
            });
        }
    });

    // Security: Prevent any potential script injection through URL parameters
    function sanitizeURLParameters() {
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.forEach((value, key) => {
            // Log any suspicious parameters (for monitoring)
            if (value.includes('<script>') || value.includes('javascript:') || value.includes('onerror=')) {
                console.warn('Suspicious URL parameter detected:', { key, value });
            }
        });
    }

    // Run URL sanitization on load
    sanitizeURLParameters();

    console.log('üîí Secure Coding Guide Loaded Successfully!');
    console.log('üìß Contact: imritikraj0@gmail.com');
    console.log('üêõ YouTube: @Beer-with-Bugs');
    console.log('‚úÖ XSS Protection: Active');
</script>z
</body>

</html>